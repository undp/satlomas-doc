{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"SatLomas \u00b6 Esta es la documentaci\u00f3n oficial de SatLomas, la plataforma de monitoreo satelital del ecosistema de las Lomas, desarrollada por Dymaxion Labs para el Proyecto EbA Lomas, que es ejecutado por PNUD bajo la direcci\u00f3n del SERNANP. La \u00faltima versi\u00f3n se encuentra disponible aqu\u00ed . Secciones \u00b6 Gu\u00eda de Uso : Gu\u00eda para utilizar y administrar la herramienta, tanto para usuarios como administradores. Metodolog\u00eda : Documento donde se describen las fuentes de datos y procesos utilizados para generar los mapas. Implementaci\u00f3n : Documento que detalla instrucciones sobre c\u00f3mo implementar la plataforma en un entorno de producci\u00f3n, destinado para administradores de sistemas. C\u00f3digo fuente \u00b6 El contenido de este sitio web est\u00e1 disponible en este repositorio y es posible sugerir cambios y modificaciones desde all\u00ed, o haciendo clic en el Bot\u00f3n de edici\u00f3n, en la derecha del t\u00edtulo de cada p\u00e1gina.","title":"Inicio"},{"location":"#satlomas","text":"Esta es la documentaci\u00f3n oficial de SatLomas, la plataforma de monitoreo satelital del ecosistema de las Lomas, desarrollada por Dymaxion Labs para el Proyecto EbA Lomas, que es ejecutado por PNUD bajo la direcci\u00f3n del SERNANP. La \u00faltima versi\u00f3n se encuentra disponible aqu\u00ed .","title":"SatLomas"},{"location":"#secciones","text":"Gu\u00eda de Uso : Gu\u00eda para utilizar y administrar la herramienta, tanto para usuarios como administradores. Metodolog\u00eda : Documento donde se describen las fuentes de datos y procesos utilizados para generar los mapas. Implementaci\u00f3n : Documento que detalla instrucciones sobre c\u00f3mo implementar la plataforma en un entorno de producci\u00f3n, destinado para administradores de sistemas.","title":"Secciones"},{"location":"#codigo-fuente","text":"El contenido de este sitio web est\u00e1 disponible en este repositorio y es posible sugerir cambios y modificaciones desde all\u00ed, o haciendo clic en el Bot\u00f3n de edici\u00f3n, en la derecha del t\u00edtulo de cada p\u00e1gina.","title":"C\u00f3digo fuente"},{"location":"deploy/","text":"Implementaci\u00f3n \u00b6 En esta secci\u00f3n se detallan instrucciones para poder implementar la plataforma en producci\u00f3n. Este documento apunta a operadores y administradores de sistemas que necesiten poner en funcionamiento la plataforma en un servidor, y por lo tanto se asumen conocimientos b\u00e1sciso de manejo de terminal, instalaci\u00f3n de paquetes y configuraci\u00f3n de servicios. En los repositorios se incluyen ejemplos de archivos de configuraci\u00f3n cuando es apropiado, pero siempre se deben tomar como ejemplos y ajustar seg\u00fan sea necesario a su criterio. Requerimientos de SO Se asume que la plataforma va a ejecutarse en un entorno con la distribuci\u00f3n Ubuntu 18.04 instalada. Para otros sistemas operativos, ser\u00e1 necesario consultar la documentaci\u00f3n correspondiente de las dependencias. Dependencias \u00b6 La plataforma consiste en un backend, implementado sobre Python, y un frontend implementado en Nodejs. Utiliza PostgreSQL como base de datos, y Redis como cache y base de datos para la cola de trabajos. A continuaci\u00f3n se detallan instrucciones para instalar y configurar estas dependencias. PostgreSQL y extensiones (TimescaleDB y PostGIS) \u00b6 S\u00f3lo para Ubuntu 18.04 Las instrucciones est\u00e1n pensadas para Ubuntu 18.04. Puede verificar la gu\u00eda de instalaci\u00f3n de TimescaleDB si est\u00e1 utilizando otro sistema operativo. Agregue el siguiente repositorio de PostgreSQL para obtener la \u00faltimas versiones de los pquetes de PostgreSQL (esto es necesario para versiones de Ubuntu menores a 19.04). # `lsb_release -c -s` should return the correct codename of your OS echo \"deb http://apt.postgresql.org/pub/repos/apt/ $( lsb_release -c -s ) -pgdg main\" | sudo tee /etc/apt/sources.list.d/pgdg.list wget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add - sudo apt-get update Agregue el repositorio de TimescaleDB y luego instale TimescaleDB, que al hacerlo automaticamente descargar\u00e1 e instalar\u00e1 tambi\u00e9n la versi\u00f3n correcta del servidor de PostgreSQL. # Add TimescaleDBs PPA sudo add-apt-repository -y ppa:timescale/timescaledb-ppa sudo apt-get update # Now install appropriate package for PG version sudo apt install timescaledb-postgresql-11 Es recomendable que utilice la herramienta timescaledb-tune para ajustar y optimizar la base de datos para TimescaleDB. sudo timescaledb-tune Ahora, instale la extensi\u00f3n PostGIS 3 para esta versi\u00f3n de PostgreSQL. sudo apt-get install -y postgresql-11-postgis-3 Finalmente, reinicie la instancia de PostgreSQL. sudo service postgresql restart Python, Redis, GDAL \u00b6 Instale Python y otras dependencias como GDAL y el servidor de Redis. sudo apt-get install -y \\ build-essential \\ git \\ gdal-bin \\ gettext \\ libgdal-dev \\ libpq-dev \\ libproj-dev \\ python3 \\ python3-dev \\ python3-pip \\ redis-server Nginx \u00b6 Nginx se utiliza para servir tanto el backend (API y administrador) como el frontend (sitio web de la plataforma). Instale Nginx desde los repositorios de Ubuntu: sudo apt install nginx Backend \u00b6 Instalaci\u00f3n \u00b6 Primero clone el repositorio del backend. git clone https://github.com/undp/satlomas-back.git cd satlomas-back/ Para instalar las dependencias correctas del backend, debe instalar el manejador de paquetes Pipenv . sudo -H pip3 install -U pipenv Luego, ejecute lo siguiente para instalar todas las dependencias necesarias. Esto crear\u00e1 un entorno virtual para este proyecto. pipenv install Una vez que finalize la instalaci\u00f3n, estar\u00e1 listo para configurar el backend. Configuraci\u00f3n \u00b6 Base de datos \u00b6 Cree un rol de superusuario para el usuario que est\u00e1 utilizando actualmente. Si sabe que va a ejecutar PostgreSQL con otros usuario, por favor reemplaze la variable $USER como corresponde. sudo -u postgres createuser -s $USER Cree la base de datos. createdb satlomas Configure una contrase\u00f1a para el usuario que acaba de crear. Ejecute el siguiente comando reemplazando foobar por una contrase\u00f1a \u00fanica: Contrase\u00f1a Es muy importante que defina una contrase\u00f1a \u00fanica y dificil de adivinar. psql satlomas -c \"ALTER USER $USER WITH PASSWORD 'foobar'\" Agregue las extensiones TimescaleDB y PostGIS a la base de datos creada. psql satlomas -c \"CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE\" psql satlomas -c \"CREATE EXTENSION IF NOT EXISTS postgis CASCADE\" Registraci\u00f3n en Copernicus Open Access Hub \u00b6 Para que la plataforma pueda descargar los productos del sat\u00e9lite Sentinel-1 y Sentinel-2 de la ESA, es necesario estar registrado en Copernicus Open Access Hub . Para registrase, ingrese aqu\u00ed . Tome nota del nombre de usuario y contrase\u00f1a dado que ser\u00e1 necesario al momento de configurar el backend. Registraci\u00f3n en NASA EarthData \u00b6 Para descargar los productos de MODIS VI, es necesario estar registrado en NASA EarthData . Puede registrarse ingresando aqu\u00ed . Tome nota del nombre de usuario y contrase\u00f1a dado que ser\u00e1 necesario al momento de configurar el backend. Variables de entorno \u00b6 Copie env.sample y guarde un archivo nuevo llamada .env . cp env.sample .env Ahora edite .env seg\u00fan sus necesidades. El archivo env.sample es un ejemplo con valores por defecto para algunas variables, pero algunas de ellas debe completarlas. A continuaci\u00f3n se describen las variables que deben ser configuradas para el funcionamiento de la plataforma. Variable Descripci\u00f3n SECRET_KEY String \u00fanico de caracteres alfanum\u00e9ricos, utilizado para firmas criptogr\u00e1ficas. Puede generar uno aqu\u00ed . ALLOWED_HOSTS Lista de hosts habilitados. Deber\u00eda ingresar el dominio y/o IP p\u00fablica del servidor DB_USER Usuario de la BD (deber\u00eda ser el nombre del usuario actual) DB_PASSWORD Contrase\u00f1a de la BD (la contrase\u00f1a que defini\u00f3 antes) SCIHUB_USER Usuario de SciHub SCIHUB_PASS Contrase\u00f1a de SciHub MODIS_USER Usuario de EarthData MODIS_PASS Contrase\u00f1a de EarthData Inicializaci\u00f3n \u00b6 Ingrese al entorno virtual creado por Pipenv, y proceda con la inicializaci\u00f3n de la base de datos. pipenv shell ./manage.py migrate # Correr las migraciones Antes de continuar, deber\u00eda generar los archivos est\u00e1ticos, necesarios para el panel de administrador: ./manage.py collectstatic Finalmente, cree un superusuario para SatLomas. Este ser\u00e1 el primer usuario administrador, con el que podr\u00e1 registrar nuevos administradores o usuarios. ./manage.py createsuperuser Luego de seguir las instrucciones del comando, tendr\u00e1 un usuario y contrase\u00f1a para ingresar al administrador del backend. Frontend \u00b6 Instalaci\u00f3n \u00b6 Primero debe instalar Node v12. Ejecute los siguientes comandos: curl -sL https://deb.nodesource.com/setup_12.x | sudo -E bash - sudo apt-get install -y nodejs Luego, clone el repositorio del frontend: git clone https://github.com/undp/satlomas-front.git cd satlomas-front/ Instale todas las dependencias con npm : npm install Finalmente, ejecute el siguiente comando para generar un build del sitio web: npm run build Configuraci\u00f3n de servicios \u00b6 M\u00e1s informaci\u00f3n Esta secci\u00f3n de la documentaci\u00f3n est\u00e1 basada en la gu\u00eda How To Set Up Django with Postgres, Nginx, and Gunicorn on Ubuntu 18.04 , de Digital Ocean. Para m\u00e1s informaci\u00f3n para depurar los servicios, puede consultarla. Backend \u00b6 Comience creando un nuevo archivo para el socket del servicio del backend: sudo nano /etc/systemd/system/gunicorn.socket Copie lo siguiente dentro del archivo: [Unit] Description=gunicorn socket [Socket] ListenStream=/run/gunicorn.sock [Install] WantedBy=sockets.target Guarde y ci\u00e9rrelo. Para el siguiente paso es necesario que verifique la ruta del entorno virtual del backend. Desde el directorio del c\u00f3digo del backend, ejecute el siguiente comando: pipenv --venv Tome nota de la ruta que devuelve el comando. Ahora, cree un nuevo archivo para el servicio. El nombre de archivo del servicio deber\u00eda coincidir con el del socket, a excepci\u00f3n de la extensi\u00f3n: sudo nano /etc/systemd/system/gunicorn.service Copie el siguiente contenido: [Unit] Description=gunicorn daemon Requires=gunicorn.socket After=network.target [Service] User=ubuntu Group=www-data WorkingDirectory=/home/ubuntu/satlomas-back ExecStart=/home/ubuntu/.local/share/virtualenvs/satlomas-back-XVGhZdP0/bin/gunicorn \\ --access-logfile - \\ --timeout 600 \\ --workers 3 \\ --bind unix:/run/gunicorn.sock \\ satlomas.wsgi:application [Install] WantedBy=multi-user.target Ajuste WorkingDirectory a la ruta absoluta del repositorio clonado del backend. Luego, ajuste la ruta absoluta de ExecStart a la del entorno virtual de Pipenv, agregando al final /bin/gunicorn . Tambi\u00e9n ser\u00e1 necesario que defina el User y Group con el que se ejecutar\u00e1 el proceso. Este usuario deber\u00eda tener permisos para poder acceder al repositorio del backend. Puede ajustar tambi\u00e9n la cantidad de workers y el timeout permitido, o agregar otras opciones de Gunicorn si es necesario. Finalmente, puede iniciar y activar el servicio. Esto crear\u00e1 un archivo /run/gunicorn.sock y se iniciar\u00e1 el servidor. Cuando se realiza una conexi\u00f3n al socket, systemd automaticamente inicia el servicio gunicorn.service para manejar el pedido. sudo systemctl start gunicorn.socket sudo systemctl enable gunicorn.socket Frontend \u00b6 De manera similar, para el servidor web del frontend ser\u00e1 administrador por systemd. Cree un nuevo archivo para el servicio del frontend: sudo nano /etc/systemd/system/satlomas-front.service y copie el siguiente contenido: [Unit] Description=Platform frontend next.js app After=network.target [Service] Environment=NODE_ENV=production User=ubuntu Group=www-data WorkingDirectory=/home/ubuntu/satlomas-front ExecStart=/usr/bin/node server.js [Install] WantedBy=multi-user.target Ajuste WorkingDirectory a la ruta absoluta del repositorio clonado del frontend. Tambi\u00e9n ser\u00e1 necesario que defina el User y Group con el que se ejecutar\u00e1 el proceso. Este usuario deber\u00eda tener permisos para poder acceder al repositorio del backend. Finalmente, puede iniciar y activar el servicio. sudo systemctl start satlomas-front.service sudo systemctl enable satlomas-front.service Nginx \u00b6 A modo ejemplo, se presentan dos archivos de configuraci\u00f3n para Nginx, para servir el backend y frontend respectivamente. En este ejemplo, se asume que se tienen registrado el dominio satlomas.com , y dos registros A para los subdominios: api.satlomas.com : Backend app.satlomas.com : Frontend Cree un nuevo archivo /etc/nginx/sites-available/satlomas-back sudo nano /etc/nginx/sites-available/satlomas-back y copie dentro de \u00e9ste el siguiente contenido: server { server_name api.satlomas.com; location = /favicon.ico { access_log off; log_not_found off; } location /static/ { root /home/ubuntu/satlomas-back; } location / { include proxy_params; proxy_pass http://unix:/run/gunicorn.sock; proxy_connect_timeout 600; proxy_send_timeout 600; proxy_read_timeout 600; send_timeout 600; } } Ajuste server_name al subdominio que corresponda al backend, y root a la ruta absoluta del repositorio del backend (en este caso, el repositorio fue clonado dentro del directorio home del usuario ubuntu ). Luego cree otro archivo /etc/nginx/sites-available/satlomas-front sudo nano /etc/nginx/sites-available/satlomas-front y copie lo siguiente: server { server_name app.satlomas.com; location /static/ { root /home/ubuntu/satlomas-front/public; } location /_next/static/ { alias /home/ubuntu/satlomas-front/.next/static/; } location / { # default port, could be changed if you use next with custom server proxy_pass http://localhost:3000; proxy_http_version 1.1; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection 'upgrade'; proxy_set_header Host $host; proxy_cache_bypass $http_upgrade; # if you have try_files like this, remove it from our block # otherwise next app will not work properly # try_files $uri $uri/ =404; } } Nuevamente, ajuste server_name al subdominio correspndiente para el frontend, y las ocurrencias de /home/ubuntu/satlomas-front a la ruta absoluta del repositorio del frontend. Finalmente, haga enlaces simb\u00f3licos de estos dos archivos al directorio /etc/nginx/sites-enabled/ para habilitar los sitios: sudo ln -s /etc/nginx/sites-available/satlomas-back /etc/nginx/sites-enabled/ sudo ln -s /etc/nginx/sites-available/satlomas-front /etc/nginx/sites-enabled/ y reinicie Nginx: sudo systemctl restart nginx Con esto concluye la implementaci\u00f3n de la plataforma. Podr\u00e1 acceder al backend desde http://api.satlomas.com/ , y al frontend desde http://app.satlomas.com/ (suponiendo que configur\u00f3 los sitios con esos subdominios). Configuraci\u00f3n SSL \u00b6 Es posible configurar SSL a trav\u00e9s de los certificados gratuitos de Let's Encrypt . Instrucciones para Ubuntu 18.04 Las siguientes instrucciones est\u00e1n basadas en la gu\u00eda de Certbot para la distribuci\u00f3n de Ubuntu 18.04 y Nginx. Si desea ver m\u00e1s informaci\u00f3n puede acceder aqu\u00ed . Deber\u00e1 agregar el PPA de Certbot a la lista de repositorios. Para esto, ejecute los siguientes comandos: sudo apt-get update sudo apt-get install -y software-properties-common sudo add-apt-repository -y universe sudo add-apt-repository -y ppa:certbot/certbot sudo apt-get update Ejecute este comando para instalar Certbot: sudo apt-get install -y certbot python3-certbot-nginx Ahora ejecute este comando para obtener un certificado y hacer que Certbot edite los archivos de configuraci\u00f3n de Nginx de los sitios habilitados autom\u00e1ticamente. sudo certbot --nginx El certificado se deber\u00eda actualizar automaticamente a trav\u00e9s del servicio de Certbot.","title":"Implementaci\u00f3n"},{"location":"deploy/#implementacion","text":"En esta secci\u00f3n se detallan instrucciones para poder implementar la plataforma en producci\u00f3n. Este documento apunta a operadores y administradores de sistemas que necesiten poner en funcionamiento la plataforma en un servidor, y por lo tanto se asumen conocimientos b\u00e1sciso de manejo de terminal, instalaci\u00f3n de paquetes y configuraci\u00f3n de servicios. En los repositorios se incluyen ejemplos de archivos de configuraci\u00f3n cuando es apropiado, pero siempre se deben tomar como ejemplos y ajustar seg\u00fan sea necesario a su criterio. Requerimientos de SO Se asume que la plataforma va a ejecutarse en un entorno con la distribuci\u00f3n Ubuntu 18.04 instalada. Para otros sistemas operativos, ser\u00e1 necesario consultar la documentaci\u00f3n correspondiente de las dependencias.","title":"Implementaci\u00f3n"},{"location":"deploy/#dependencias","text":"La plataforma consiste en un backend, implementado sobre Python, y un frontend implementado en Nodejs. Utiliza PostgreSQL como base de datos, y Redis como cache y base de datos para la cola de trabajos. A continuaci\u00f3n se detallan instrucciones para instalar y configurar estas dependencias.","title":"Dependencias"},{"location":"deploy/#postgresql-y-extensiones-timescaledb-y-postgis","text":"S\u00f3lo para Ubuntu 18.04 Las instrucciones est\u00e1n pensadas para Ubuntu 18.04. Puede verificar la gu\u00eda de instalaci\u00f3n de TimescaleDB si est\u00e1 utilizando otro sistema operativo. Agregue el siguiente repositorio de PostgreSQL para obtener la \u00faltimas versiones de los pquetes de PostgreSQL (esto es necesario para versiones de Ubuntu menores a 19.04). # `lsb_release -c -s` should return the correct codename of your OS echo \"deb http://apt.postgresql.org/pub/repos/apt/ $( lsb_release -c -s ) -pgdg main\" | sudo tee /etc/apt/sources.list.d/pgdg.list wget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add - sudo apt-get update Agregue el repositorio de TimescaleDB y luego instale TimescaleDB, que al hacerlo automaticamente descargar\u00e1 e instalar\u00e1 tambi\u00e9n la versi\u00f3n correcta del servidor de PostgreSQL. # Add TimescaleDBs PPA sudo add-apt-repository -y ppa:timescale/timescaledb-ppa sudo apt-get update # Now install appropriate package for PG version sudo apt install timescaledb-postgresql-11 Es recomendable que utilice la herramienta timescaledb-tune para ajustar y optimizar la base de datos para TimescaleDB. sudo timescaledb-tune Ahora, instale la extensi\u00f3n PostGIS 3 para esta versi\u00f3n de PostgreSQL. sudo apt-get install -y postgresql-11-postgis-3 Finalmente, reinicie la instancia de PostgreSQL. sudo service postgresql restart","title":"PostgreSQL y extensiones (TimescaleDB y PostGIS)"},{"location":"deploy/#python-redis-gdal","text":"Instale Python y otras dependencias como GDAL y el servidor de Redis. sudo apt-get install -y \\ build-essential \\ git \\ gdal-bin \\ gettext \\ libgdal-dev \\ libpq-dev \\ libproj-dev \\ python3 \\ python3-dev \\ python3-pip \\ redis-server","title":"Python, Redis, GDAL"},{"location":"deploy/#nginx","text":"Nginx se utiliza para servir tanto el backend (API y administrador) como el frontend (sitio web de la plataforma). Instale Nginx desde los repositorios de Ubuntu: sudo apt install nginx","title":"Nginx"},{"location":"deploy/#backend","text":"","title":"Backend"},{"location":"deploy/#instalacion","text":"Primero clone el repositorio del backend. git clone https://github.com/undp/satlomas-back.git cd satlomas-back/ Para instalar las dependencias correctas del backend, debe instalar el manejador de paquetes Pipenv . sudo -H pip3 install -U pipenv Luego, ejecute lo siguiente para instalar todas las dependencias necesarias. Esto crear\u00e1 un entorno virtual para este proyecto. pipenv install Una vez que finalize la instalaci\u00f3n, estar\u00e1 listo para configurar el backend.","title":"Instalaci\u00f3n"},{"location":"deploy/#configuracion","text":"","title":"Configuraci\u00f3n"},{"location":"deploy/#base-de-datos","text":"Cree un rol de superusuario para el usuario que est\u00e1 utilizando actualmente. Si sabe que va a ejecutar PostgreSQL con otros usuario, por favor reemplaze la variable $USER como corresponde. sudo -u postgres createuser -s $USER Cree la base de datos. createdb satlomas Configure una contrase\u00f1a para el usuario que acaba de crear. Ejecute el siguiente comando reemplazando foobar por una contrase\u00f1a \u00fanica: Contrase\u00f1a Es muy importante que defina una contrase\u00f1a \u00fanica y dificil de adivinar. psql satlomas -c \"ALTER USER $USER WITH PASSWORD 'foobar'\" Agregue las extensiones TimescaleDB y PostGIS a la base de datos creada. psql satlomas -c \"CREATE EXTENSION IF NOT EXISTS timescaledb CASCADE\" psql satlomas -c \"CREATE EXTENSION IF NOT EXISTS postgis CASCADE\"","title":"Base de datos"},{"location":"deploy/#registracion-en-copernicus-open-access-hub","text":"Para que la plataforma pueda descargar los productos del sat\u00e9lite Sentinel-1 y Sentinel-2 de la ESA, es necesario estar registrado en Copernicus Open Access Hub . Para registrase, ingrese aqu\u00ed . Tome nota del nombre de usuario y contrase\u00f1a dado que ser\u00e1 necesario al momento de configurar el backend.","title":"Registraci\u00f3n en Copernicus Open Access Hub"},{"location":"deploy/#registracion-en-nasa-earthdata","text":"Para descargar los productos de MODIS VI, es necesario estar registrado en NASA EarthData . Puede registrarse ingresando aqu\u00ed . Tome nota del nombre de usuario y contrase\u00f1a dado que ser\u00e1 necesario al momento de configurar el backend.","title":"Registraci\u00f3n en NASA EarthData"},{"location":"deploy/#variables-de-entorno","text":"Copie env.sample y guarde un archivo nuevo llamada .env . cp env.sample .env Ahora edite .env seg\u00fan sus necesidades. El archivo env.sample es un ejemplo con valores por defecto para algunas variables, pero algunas de ellas debe completarlas. A continuaci\u00f3n se describen las variables que deben ser configuradas para el funcionamiento de la plataforma. Variable Descripci\u00f3n SECRET_KEY String \u00fanico de caracteres alfanum\u00e9ricos, utilizado para firmas criptogr\u00e1ficas. Puede generar uno aqu\u00ed . ALLOWED_HOSTS Lista de hosts habilitados. Deber\u00eda ingresar el dominio y/o IP p\u00fablica del servidor DB_USER Usuario de la BD (deber\u00eda ser el nombre del usuario actual) DB_PASSWORD Contrase\u00f1a de la BD (la contrase\u00f1a que defini\u00f3 antes) SCIHUB_USER Usuario de SciHub SCIHUB_PASS Contrase\u00f1a de SciHub MODIS_USER Usuario de EarthData MODIS_PASS Contrase\u00f1a de EarthData","title":"Variables de entorno"},{"location":"deploy/#inicializacion","text":"Ingrese al entorno virtual creado por Pipenv, y proceda con la inicializaci\u00f3n de la base de datos. pipenv shell ./manage.py migrate # Correr las migraciones Antes de continuar, deber\u00eda generar los archivos est\u00e1ticos, necesarios para el panel de administrador: ./manage.py collectstatic Finalmente, cree un superusuario para SatLomas. Este ser\u00e1 el primer usuario administrador, con el que podr\u00e1 registrar nuevos administradores o usuarios. ./manage.py createsuperuser Luego de seguir las instrucciones del comando, tendr\u00e1 un usuario y contrase\u00f1a para ingresar al administrador del backend.","title":"Inicializaci\u00f3n"},{"location":"deploy/#frontend","text":"","title":"Frontend"},{"location":"deploy/#instalacion_1","text":"Primero debe instalar Node v12. Ejecute los siguientes comandos: curl -sL https://deb.nodesource.com/setup_12.x | sudo -E bash - sudo apt-get install -y nodejs Luego, clone el repositorio del frontend: git clone https://github.com/undp/satlomas-front.git cd satlomas-front/ Instale todas las dependencias con npm : npm install Finalmente, ejecute el siguiente comando para generar un build del sitio web: npm run build","title":"Instalaci\u00f3n"},{"location":"deploy/#configuracion-de-servicios","text":"M\u00e1s informaci\u00f3n Esta secci\u00f3n de la documentaci\u00f3n est\u00e1 basada en la gu\u00eda How To Set Up Django with Postgres, Nginx, and Gunicorn on Ubuntu 18.04 , de Digital Ocean. Para m\u00e1s informaci\u00f3n para depurar los servicios, puede consultarla.","title":"Configuraci\u00f3n de servicios"},{"location":"deploy/#backend_1","text":"Comience creando un nuevo archivo para el socket del servicio del backend: sudo nano /etc/systemd/system/gunicorn.socket Copie lo siguiente dentro del archivo: [Unit] Description=gunicorn socket [Socket] ListenStream=/run/gunicorn.sock [Install] WantedBy=sockets.target Guarde y ci\u00e9rrelo. Para el siguiente paso es necesario que verifique la ruta del entorno virtual del backend. Desde el directorio del c\u00f3digo del backend, ejecute el siguiente comando: pipenv --venv Tome nota de la ruta que devuelve el comando. Ahora, cree un nuevo archivo para el servicio. El nombre de archivo del servicio deber\u00eda coincidir con el del socket, a excepci\u00f3n de la extensi\u00f3n: sudo nano /etc/systemd/system/gunicorn.service Copie el siguiente contenido: [Unit] Description=gunicorn daemon Requires=gunicorn.socket After=network.target [Service] User=ubuntu Group=www-data WorkingDirectory=/home/ubuntu/satlomas-back ExecStart=/home/ubuntu/.local/share/virtualenvs/satlomas-back-XVGhZdP0/bin/gunicorn \\ --access-logfile - \\ --timeout 600 \\ --workers 3 \\ --bind unix:/run/gunicorn.sock \\ satlomas.wsgi:application [Install] WantedBy=multi-user.target Ajuste WorkingDirectory a la ruta absoluta del repositorio clonado del backend. Luego, ajuste la ruta absoluta de ExecStart a la del entorno virtual de Pipenv, agregando al final /bin/gunicorn . Tambi\u00e9n ser\u00e1 necesario que defina el User y Group con el que se ejecutar\u00e1 el proceso. Este usuario deber\u00eda tener permisos para poder acceder al repositorio del backend. Puede ajustar tambi\u00e9n la cantidad de workers y el timeout permitido, o agregar otras opciones de Gunicorn si es necesario. Finalmente, puede iniciar y activar el servicio. Esto crear\u00e1 un archivo /run/gunicorn.sock y se iniciar\u00e1 el servidor. Cuando se realiza una conexi\u00f3n al socket, systemd automaticamente inicia el servicio gunicorn.service para manejar el pedido. sudo systemctl start gunicorn.socket sudo systemctl enable gunicorn.socket","title":"Backend"},{"location":"deploy/#frontend_1","text":"De manera similar, para el servidor web del frontend ser\u00e1 administrador por systemd. Cree un nuevo archivo para el servicio del frontend: sudo nano /etc/systemd/system/satlomas-front.service y copie el siguiente contenido: [Unit] Description=Platform frontend next.js app After=network.target [Service] Environment=NODE_ENV=production User=ubuntu Group=www-data WorkingDirectory=/home/ubuntu/satlomas-front ExecStart=/usr/bin/node server.js [Install] WantedBy=multi-user.target Ajuste WorkingDirectory a la ruta absoluta del repositorio clonado del frontend. Tambi\u00e9n ser\u00e1 necesario que defina el User y Group con el que se ejecutar\u00e1 el proceso. Este usuario deber\u00eda tener permisos para poder acceder al repositorio del backend. Finalmente, puede iniciar y activar el servicio. sudo systemctl start satlomas-front.service sudo systemctl enable satlomas-front.service","title":"Frontend"},{"location":"deploy/#nginx_1","text":"A modo ejemplo, se presentan dos archivos de configuraci\u00f3n para Nginx, para servir el backend y frontend respectivamente. En este ejemplo, se asume que se tienen registrado el dominio satlomas.com , y dos registros A para los subdominios: api.satlomas.com : Backend app.satlomas.com : Frontend Cree un nuevo archivo /etc/nginx/sites-available/satlomas-back sudo nano /etc/nginx/sites-available/satlomas-back y copie dentro de \u00e9ste el siguiente contenido: server { server_name api.satlomas.com; location = /favicon.ico { access_log off; log_not_found off; } location /static/ { root /home/ubuntu/satlomas-back; } location / { include proxy_params; proxy_pass http://unix:/run/gunicorn.sock; proxy_connect_timeout 600; proxy_send_timeout 600; proxy_read_timeout 600; send_timeout 600; } } Ajuste server_name al subdominio que corresponda al backend, y root a la ruta absoluta del repositorio del backend (en este caso, el repositorio fue clonado dentro del directorio home del usuario ubuntu ). Luego cree otro archivo /etc/nginx/sites-available/satlomas-front sudo nano /etc/nginx/sites-available/satlomas-front y copie lo siguiente: server { server_name app.satlomas.com; location /static/ { root /home/ubuntu/satlomas-front/public; } location /_next/static/ { alias /home/ubuntu/satlomas-front/.next/static/; } location / { # default port, could be changed if you use next with custom server proxy_pass http://localhost:3000; proxy_http_version 1.1; proxy_set_header Upgrade $http_upgrade; proxy_set_header Connection 'upgrade'; proxy_set_header Host $host; proxy_cache_bypass $http_upgrade; # if you have try_files like this, remove it from our block # otherwise next app will not work properly # try_files $uri $uri/ =404; } } Nuevamente, ajuste server_name al subdominio correspndiente para el frontend, y las ocurrencias de /home/ubuntu/satlomas-front a la ruta absoluta del repositorio del frontend. Finalmente, haga enlaces simb\u00f3licos de estos dos archivos al directorio /etc/nginx/sites-enabled/ para habilitar los sitios: sudo ln -s /etc/nginx/sites-available/satlomas-back /etc/nginx/sites-enabled/ sudo ln -s /etc/nginx/sites-available/satlomas-front /etc/nginx/sites-enabled/ y reinicie Nginx: sudo systemctl restart nginx Con esto concluye la implementaci\u00f3n de la plataforma. Podr\u00e1 acceder al backend desde http://api.satlomas.com/ , y al frontend desde http://app.satlomas.com/ (suponiendo que configur\u00f3 los sitios con esos subdominios).","title":"Nginx"},{"location":"deploy/#configuracion-ssl","text":"Es posible configurar SSL a trav\u00e9s de los certificados gratuitos de Let's Encrypt . Instrucciones para Ubuntu 18.04 Las siguientes instrucciones est\u00e1n basadas en la gu\u00eda de Certbot para la distribuci\u00f3n de Ubuntu 18.04 y Nginx. Si desea ver m\u00e1s informaci\u00f3n puede acceder aqu\u00ed . Deber\u00e1 agregar el PPA de Certbot a la lista de repositorios. Para esto, ejecute los siguientes comandos: sudo apt-get update sudo apt-get install -y software-properties-common sudo add-apt-repository -y universe sudo add-apt-repository -y ppa:certbot/certbot sudo apt-get update Ejecute este comando para instalar Certbot: sudo apt-get install -y certbot python3-certbot-nginx Ahora ejecute este comando para obtener un certificado y hacer que Certbot edite los archivos de configuraci\u00f3n de Nginx de los sitios habilitados autom\u00e1ticamente. sudo certbot --nginx El certificado se deber\u00eda actualizar automaticamente a trav\u00e9s del servicio de Certbot.","title":"Configuraci\u00f3n SSL"},{"location":"development/","text":"Desarrollo \u00b6 Aselli instabilis Alpes \u00b6 Lorem markdownum spectatorem interdictae cessere quaedam. Hanc sine que laesasque fecundo: est sonus? Sine enim. Pars fuit abstulit semina de grandia Erectheus ille sit defrenato sanguine Iuppiter coquiturque satis neque tumulo cervos exsanguemque. Videt ne veri decoris, hirsuti solverat cumque, cornibus intendens utque? Hanc ipse, qui Caeneus qui deum poscit, orbe, pascere primo sit qui optavit. Facioque erat iussit ad omnem extremum mensis Unde Crantoris Vosne belua Iamque dracones concussit quam regnaque credar aetatem Nomine quem baca vetuit Mansit parte, a invitaque pio redeuntibus passa celebres eadem. Quem caelo terras certamen natant; pactus umbra spina usum profectu nondum accipiunt arbor! Comitantibus quae \u00b6 Cervicis effugiam ramis murus et quam est praemia effundit seminaque, ut tenebat, quo ora pectore loquaci, nam. Caput concita, dicenti cervi undis, prohibemur inmemor omnia saevus culpa. Fiat quo habenti damno, si sua medio factis; non ferantur , destringere ibat! backlink_wizard_search = bluetoothClipboardSystem / 2 ; if ( deprecated ) { type ( dvd_recycle , megabyte ( 707213 , compressionSimm )); gnu ( clipboardInstall , qbe ); power_daemon_right ( batch , balance_static , softTrojanMenu ); } var cloudRetinaFtp = peopleware_flash + refresh * ip_macintosh ; Sunt Iovem transferre petuntur esset adparuit Melas, docebo hoc moderante neque inspirantque mandata etiamnum fastigiaque longo felices. Pes fallit, nomen ungues utque adducor quamvis laquei turis. Sollicitae erat antiquas poteris. Sum illinc Saepe fieri Fuit luna vince caede rebus Phoebo sui Albente recentes cruciatibus trabes deficiunt gradumque spumeus Exierat cum plura ima partu umbrosum errent Ut Aiacem mensae ; ait est comitesque ferat flexuque est quem effluxere probat moenia: quae non suadet adorat. Suique sis classis carinae loquendi futura. Et visa est sic superum pectus concipiunt pater animalia proxima.","title":"Desarrollo"},{"location":"development/#desarrollo","text":"","title":"Desarrollo"},{"location":"development/#aselli-instabilis-alpes","text":"Lorem markdownum spectatorem interdictae cessere quaedam. Hanc sine que laesasque fecundo: est sonus? Sine enim. Pars fuit abstulit semina de grandia Erectheus ille sit defrenato sanguine Iuppiter coquiturque satis neque tumulo cervos exsanguemque. Videt ne veri decoris, hirsuti solverat cumque, cornibus intendens utque? Hanc ipse, qui Caeneus qui deum poscit, orbe, pascere primo sit qui optavit. Facioque erat iussit ad omnem extremum mensis Unde Crantoris Vosne belua Iamque dracones concussit quam regnaque credar aetatem Nomine quem baca vetuit Mansit parte, a invitaque pio redeuntibus passa celebres eadem. Quem caelo terras certamen natant; pactus umbra spina usum profectu nondum accipiunt arbor!","title":"Aselli instabilis Alpes"},{"location":"development/#comitantibus-quae","text":"Cervicis effugiam ramis murus et quam est praemia effundit seminaque, ut tenebat, quo ora pectore loquaci, nam. Caput concita, dicenti cervi undis, prohibemur inmemor omnia saevus culpa. Fiat quo habenti damno, si sua medio factis; non ferantur , destringere ibat! backlink_wizard_search = bluetoothClipboardSystem / 2 ; if ( deprecated ) { type ( dvd_recycle , megabyte ( 707213 , compressionSimm )); gnu ( clipboardInstall , qbe ); power_daemon_right ( batch , balance_static , softTrojanMenu ); } var cloudRetinaFtp = peopleware_flash + refresh * ip_macintosh ; Sunt Iovem transferre petuntur esset adparuit Melas, docebo hoc moderante neque inspirantque mandata etiamnum fastigiaque longo felices. Pes fallit, nomen ungues utque adducor quamvis laquei turis. Sollicitae erat antiquas poteris. Sum illinc Saepe fieri Fuit luna vince caede rebus Phoebo sui Albente recentes cruciatibus trabes deficiunt gradumque spumeus Exierat cum plura ima partu umbrosum errent Ut Aiacem mensae ; ait est comitesque ferat flexuque est quem effluxere probat moenia: quae non suadet adorat. Suique sis classis carinae loquendi futura. Et visa est sic superum pectus concipiunt pater animalia proxima.","title":"Comitantibus quae"},{"location":"methodology/","text":"Metodolog\u00eda \u00b6 Modelo de clasificaci\u00f3n de cobertura del suelo para invasiones \u00b6 En esta secci\u00f3n se detallan las fuentes de datos que est\u00e1n siendo utilizadas para el modelo de clasificaci\u00f3n de cobertura del suelo, los procedimientos para calibrar las im\u00e1genes, y los resultados preliminares del modelo de aprendizaje autom\u00e1tico aplicado. Fuentes de datos \u00b6 Im\u00e1genes satelitales \u00b6 Para analizar el problema a partir de las im\u00e1genes satelitales disponibles para el proyecto, se prepararon y descargaron mosaicos trimestrales de escenas del sensor Sentinel-2 (ESA), desde el a\u00f1o 2015 hasta noviembre del a\u00f1o 2019, de todo el ecosistema de las Lomas. La resoluci\u00f3n espacial de las im\u00e1genes de Sentinel-2 es de 10m por pixel para las bandas RGB (rojo, verde y azul) y NIR (infrarrojo cercano), y de 20m para el resto de las bandas del infrarrojo. El tiempo de revisita es de aproximadamente 10 d\u00edas. A partir de la inspecci\u00f3n visual, se consensu\u00f3 con el equipo de EbA Lomas el uso de mosaicos bimestrales de escenas de Sentinel-2. En el caso de que haya regiones cubiertas por nubes en alg\u00fan momento del a\u00f1o, se completar\u00e1 con escenas de Sentinel-1. Este sensor es muy utilizado en la pr\u00e1ctica para detectar inundaciones o edificaciones, dado que permite observar el suelo a\u00fan con nubosidad. Las im\u00e1genes de Sentinel-1 y Sentinel-2 se descargaron de los repositorios abiertos de Copernicus Open Access Hub. Tambi\u00e9n se utiliz\u00f3 el modelo de elevaci\u00f3n digital (DEM) del SRTM (Shuttle Radar Topography Mission), puesto que la informaci\u00f3n de altitud es relevante a la hora de determinar suelo de las Lomas. La resoluci\u00f3n espacial de esta capa r\u00e1ster es de 30 m por p\u00edxel aproximadamente (1-arc second). Datos vectoriales \u00b6 Se est\u00e1 trabajando sobre un conjunto de capas vectoriales de pol\u00edgonos proporcionados por el equipo de EbA Lomas. El \u00e1rea de inter\u00e9s (AOI) donde se analizan cambios de cobertura de suelo, tanto de vegetaci\u00f3n como de invasiones de tierras, est\u00e1 basado en el shapefile El Ni\u00f1o Southern Oscillation (ENSO) 1997-1998 Lomas . \u00c9ste representa la m\u00e1xima extensi\u00f3n en los \u00faltimos 20 a\u00f1os de precipitaciones inusuales, y fue obtenida de im\u00e1genes del sensor TM del Landsat-5. Se tom\u00f3 un buffer para contemplar posibles expansiones. Tambi\u00e9n se utilizaron los siguientes shapefiles como referencia para hacer anotaciones de verdad de campo: Lomas anuales . Es la superficie que se vuelve verde en la temporada de niebla (Junio-Septiembre) 2016-2018 Informal Settlements 2017-2019 Waste Pile Preprocesamiento de im\u00e1genes \u00b6 Sentinel-2 \u00b6 Para poder utilizar las im\u00e1genes multiespectrales de Sentinel-2 y las im\u00e1genes SAR de Sentinel-1 fue necesario aplicar una serie de pasos de calibraci\u00f3n. Dado que se descargaron escenas de nivel L1C para Sentinel-2, fue necesario ejecutar la herramienta de c\u00f3digo abierto sen2cor, provista por la plataforma de la ESA. Este proceso realiza las correcciones atmosf\u00e9ricas y geom\u00e9tricas de las escenas y genera una versi\u00f3n de las im\u00e1genes a nivel bottom-of-atmosphere, designado como nivel L2A. Tambi\u00e9n genera una m\u00e1scara de nubes, que luego utilizamos para descartar aquellos p\u00edxeles de la imagen que est\u00e1n cubiertos de nubes. Estos p\u00edxeles no son v\u00e1lidos para el modelo, y ser\u00e1n reemplazados por los de la imagen de Sentinel-1 del per\u00edodo correspondiente. Para generar el mosaico, aplicamos la herramienta de c\u00f3digo abierto sen2mosaic, para Python. Sentinel-1 \u00b6 Para trabajar con las im\u00e1genes de este sensor para la detecci\u00f3n de edificaciones y cambios en la cobertura del suelo, se descargaron escenas del producto GRD (Ground Range Detected) donde los valores de los p\u00edxeles representan la magnitud detectada. La resoluci\u00f3n espacial de estas im\u00e1genes es de aproximadamente 10m por p\u00edxel. Luego de descargar los productos se procede con la calibraci\u00f3n radiom\u00e9trica, que permite calcular el valor sigma0 de las bandas de polarizaci\u00f3n VV y VH. Al hacer esta calibraci\u00f3n, tambi\u00e9n se utiliza el DEM de SRTM para ortorectificar las im\u00e1genes. El segundo paso es la eliminaci\u00f3n del ruido Speckle con la aplicaci\u00f3n de un filtro espec\u00edfico para este tipo de ruido, caracter\u00edstico en las im\u00e1genes SAR. El siguiente paso que realizamos es calcular la proporci\u00f3n VV/VH a partir de las bandas VV y HH, que es un atributo que utiliza el modelo de cobertura de suelo. Finalmente se concatenan las 3 bandas en una sola imagen, y se corregistran de a pares de escenas con la herramienta AROSICS. Este paso es necesario para luego poder generar el mosaico en base a todas las escenas descargadas. Finalmente se recorta la imagen con la capa vectorial del AOI. Armado del dataset \u00b6 Los datasets de entrenamiento y evaluaci\u00f3n del modelo se definieron de la siguiente manera: Im\u00e1genes de todo un a\u00f1o completo, desde noviembre del 2018 a noviembre del 2019 inclusive. Mosaicos bimestrales, de tres (3) per\u00edodos distintos de ese a\u00f1o. Cuatro (4) \u00e1reas definidas Para cada mosaico de entrenamiento hay un mosaico de evaluaci\u00f3n exactamente dos meses despu\u00e9s, cubriendo as\u00ed todos los per\u00edodos del a\u00f1o. A continuaci\u00f3n se detallan los rangos de fecha utilizados para los datasets: Train 2018-11 al 2018-12 2019-03 al 2019-04 2019-07 al 2019-08 Test 2019-01 al 2019-02 2019-05 al 2019-06 2019-09 al 2019-10 Las bandas utilizadas de cada sensor fueron las siguientes: * Sentinel-2 : 10 bandas multiespectrales - B2 (490 nm), B3 (560 nm), B4 (665 nm) y B8 (842 nm), de 10m por p\u00edxel - B5 (705 nm), B6 (740 nm), B7 (783 nm), B8a (865 nm), B11 (1610 nm) y B12 (2190 nm), de 20m por p\u00edxel * Sentinel-1 : 3 bandas: - VV, VH - VV/HH * SRTM : DEM, altitud en msnm Para cada banda, se extrajeron los siguientes atributos utilizando la herramienta de c\u00f3digo abierto Orfeo Toolbox: Estad\u00edsticas locales : 4 momentos estad\u00edsticos en la vecindad de cada pixel Media Varianza Skewness (asimetr\u00eda) Curtosis Atributos de textura de Haralick : 8 atributos locales Energy (texture uniformity) Entropy (measure of randomness of intensity image) Correlation (how correlated a pixel is to its neighborhood) Inverse Difference Moment (measures the texture homogeneity) Inertia (intensity contrast between a pixel and its neighborhood) Cluster Shade Cluster Prominence Haralick Correlation Entrenamiento preliminar y evaluaci\u00f3n \u00b6 Para evaluar la importancia de las bandas seleccionadas y los atributos extra\u00eddos, se entren\u00f3 un modelo de cobertura de suelo para las 4 \u00e1reas asignadas. Se anotaron pol\u00edgonos para las siguientes clases: - Suelo de loma natural - Suelo de loma artificial / movimiento de suelo - \u00c1rea urbana - Suelo desnudo - Vegetaci\u00f3n / campo - Agua Para cada uno de los mosaicos de cada per\u00edodo, se cort\u00f3 el raster a medida con la uni\u00f3n de las extensiones de las 4 \u00e1reas (para que los subsiguientes procesos sean m\u00e1s eficientes en memoria y c\u00f3mputo), y se extrajeron los atributos de cada una de estas im\u00e1genes. Se generaron 3 Shapefiles como resultado (1 por cada per\u00edodo), que fueron fusionados para obtener un \u00fanico Shapefile de puntos con atributos. Finalmente, se utiliz\u00f3 Orfeo Toolbox para entrenar un random forest a partir de las anotaciones, y los atributos extra\u00eddos anteriormente. Luego de ajustar los hiperpar\u00e1metros del modelo, se alcanz\u00f3 un kappa de 0.89. A continuaci\u00f3n se muestran las m\u00e9tricas y matrices de confusi\u00f3n de la mejor ejecuci\u00f3n. Par\u00e1metros: Profundidad: 9 \u00c1rboles: 175 Predicted list size : 92358 ValidationLabeledListSample size : 92358 Training performances: Confusion matrix (rows = reference labels, columns = produced labels): 1 2 3 4 5 6 1 14316 798 255 24 0 0 2 1035 12051 2082 105 0 120 3 90 978 13623 324 42 336 4 9 402 1581 13362 21 18 5 0 0 0 0 15393 0 6 0 0 129 12 6 15246 Precision of class [1] vs all: 0.926602 Recall of class [1] vs all: 0.930033 F-score of class [1] vs all: 0.928314 Precision of class [2] vs all: 0.846932 Recall of class [2] vs all: 0.782888 F-score of class [2] vs all: 0.813652 Precision of class [3] vs all: 0.770968 Recall of class [3] vs all: 0.885013 F-score of class [3] vs all: 0.824063 Precision of class [4] vs all: 0.96637 Recall of class [4] vs all: 0.868057 F-score of class [4] vs all: 0.914579 Precision of class [5] vs all: 0.995537 Recall of class [5] vs all: 1 F-score of class [5] vs all: 0.997764 Precision of class [6] vs all: 0.969847 Recall of class [6] vs all: 0.99045 F-score of class [6] vs all: 0.98004 Global performance, Kappa index: 0.891288 A continuaci\u00f3n se observan las cuatro \u00e1reas sobre un mosaico de Sentinel-2 y el resultado del clasificador correspondiente. Modelo de detecci\u00f3n de vegetaci\u00f3n \u00b6 Fuentes de datos \u00b6 El modelo de detecci\u00f3n de vegetaci\u00f3n utiliza im\u00e1genes satelitales MODIS, en particular el producto MOD13Q1.006, que cuenta con resoluci\u00f3n espacial de 250m y temporal de 16 d\u00edas. Se cuenta con una imagen por mes, desde enero 2014 a noviembre 2019. Las im\u00e1genes MODIS se complementan con el modelo de elevaci\u00f3n digital (DEM) del SRTM, mencionado anteriormente. Adem\u00e1s se cuenta con la definici\u00f3n del \u00e1rea de an\u00e1lisis propuesta por el equipo de EbA Lomas. Para definir la misma, en el \u00e1mbito de las provincias de Lima y Callao, se consider\u00f3 lo siguiente: \u00c1reas localizadas entre los 200 y 1800 msnm conforme al art\u00edculo de Le\u00f3n (2017). Las curvas de nivel fueron extra\u00eddas de la carta nacional 1:100 000 del Instituto Geogr\u00e1fico Nacional. Exclusi\u00f3n de zonas con presencia de campos agr\u00edcolas, forestaci\u00f3n densa de laderas aleda\u00f1as a zonas urbanas y/o agr\u00edcolas, empleando una imagen Spot (2017). Exclusi\u00f3n de zonas urbanas consolidadas con un buffer de 30m de acuerdo al INEI (2016). Metodolog\u00eda \u00b6 En primer lugar se recortaron las im\u00e1genes MODIS y SRTM al \u00e1rea de estudio propuesta por el equipo de EbA Lomas. Partiendo de los datos MODIS del \u00e1rea a monitorear, se determin\u00f3 mediante un umbral NDVI aquellos pixeles que representaban vegetaci\u00f3n. Dicho umbral fue definido en 0.2, tomando como fuente al art\u00edculo de Le\u00f3n (2017), donde se indica que un valor inferior a 0.2 representa suelo desnudo. Luego con las im\u00e1genes SRTM del \u00e1rea a monitorear, se determin\u00f3 la presencia o no de las Lomas. Tomando como Lomas los lugares con altura entre 200 y 1800 msnm. Finalmente consideramos como informaci\u00f3n relevante para la capa verde, aquellos p\u00edxeles que cumplen ambas condiciones, es decir presentan tanto vegetaci\u00f3n como las condiciones que definen a la Loma. Se genera como resultado, para cada mes, dos tipos de capas r\u00e1ster: * Rango NDVI: resultado complementario, donde se discretizan los valores NDVI en 4 rangos. * M\u00e1scara Verde: un valor 0 o 1 para cada p\u00edxel, seg\u00fan cumple las condiciones mencionadas anteriormente. * M\u00e1scara de Nubes: determina si un pixel fue considerado como nube en el producto original de MODIS. Luego de un an\u00e1lisis posterior de los resultados, se incluy\u00f3 un paso de postprocesamiento que aplica una m\u00e1scara conformada por pol\u00edgonos, con el objetivo de excluir vegetaci\u00f3n no relacionada al ecosistema de Lomas (por ejemplo: zonas agr\u00edcolas, urbanas, periurbanas). Por otro lado, debido a que la resoluci\u00f3n del producto MODIS es muy baja, en determinados casos se terminan incluyendo \u00e1reas con vegetaci\u00f3n en los bordes de zonas agr\u00edcolas. Con el fin de resolver este problema, se aplic\u00f3 un buffer para reducir el \u00e1rea de inclusi\u00f3n en los bordes y evitar este problema. La m\u00e1scara de nubes se genera extrayendo los p\u00edxeles catalogados como \"nube\" en el dataset Pixel reliability del producto MOD13Q1. Para m\u00e1s informaci\u00f3n acerca del producto MOD13Q1 se recomienda leer la Guia de Usuario .","title":"Metodolog\u00eda"},{"location":"methodology/#metodologia","text":"","title":"Metodolog\u00eda"},{"location":"methodology/#modelo-de-clasificacion-de-cobertura-del-suelo-para-invasiones","text":"En esta secci\u00f3n se detallan las fuentes de datos que est\u00e1n siendo utilizadas para el modelo de clasificaci\u00f3n de cobertura del suelo, los procedimientos para calibrar las im\u00e1genes, y los resultados preliminares del modelo de aprendizaje autom\u00e1tico aplicado.","title":"Modelo de clasificaci\u00f3n de cobertura del suelo para invasiones"},{"location":"methodology/#fuentes-de-datos","text":"","title":"Fuentes de datos"},{"location":"methodology/#imagenes-satelitales","text":"Para analizar el problema a partir de las im\u00e1genes satelitales disponibles para el proyecto, se prepararon y descargaron mosaicos trimestrales de escenas del sensor Sentinel-2 (ESA), desde el a\u00f1o 2015 hasta noviembre del a\u00f1o 2019, de todo el ecosistema de las Lomas. La resoluci\u00f3n espacial de las im\u00e1genes de Sentinel-2 es de 10m por pixel para las bandas RGB (rojo, verde y azul) y NIR (infrarrojo cercano), y de 20m para el resto de las bandas del infrarrojo. El tiempo de revisita es de aproximadamente 10 d\u00edas. A partir de la inspecci\u00f3n visual, se consensu\u00f3 con el equipo de EbA Lomas el uso de mosaicos bimestrales de escenas de Sentinel-2. En el caso de que haya regiones cubiertas por nubes en alg\u00fan momento del a\u00f1o, se completar\u00e1 con escenas de Sentinel-1. Este sensor es muy utilizado en la pr\u00e1ctica para detectar inundaciones o edificaciones, dado que permite observar el suelo a\u00fan con nubosidad. Las im\u00e1genes de Sentinel-1 y Sentinel-2 se descargaron de los repositorios abiertos de Copernicus Open Access Hub. Tambi\u00e9n se utiliz\u00f3 el modelo de elevaci\u00f3n digital (DEM) del SRTM (Shuttle Radar Topography Mission), puesto que la informaci\u00f3n de altitud es relevante a la hora de determinar suelo de las Lomas. La resoluci\u00f3n espacial de esta capa r\u00e1ster es de 30 m por p\u00edxel aproximadamente (1-arc second).","title":"Im\u00e1genes satelitales"},{"location":"methodology/#datos-vectoriales","text":"Se est\u00e1 trabajando sobre un conjunto de capas vectoriales de pol\u00edgonos proporcionados por el equipo de EbA Lomas. El \u00e1rea de inter\u00e9s (AOI) donde se analizan cambios de cobertura de suelo, tanto de vegetaci\u00f3n como de invasiones de tierras, est\u00e1 basado en el shapefile El Ni\u00f1o Southern Oscillation (ENSO) 1997-1998 Lomas . \u00c9ste representa la m\u00e1xima extensi\u00f3n en los \u00faltimos 20 a\u00f1os de precipitaciones inusuales, y fue obtenida de im\u00e1genes del sensor TM del Landsat-5. Se tom\u00f3 un buffer para contemplar posibles expansiones. Tambi\u00e9n se utilizaron los siguientes shapefiles como referencia para hacer anotaciones de verdad de campo: Lomas anuales . Es la superficie que se vuelve verde en la temporada de niebla (Junio-Septiembre) 2016-2018 Informal Settlements 2017-2019 Waste Pile","title":"Datos vectoriales"},{"location":"methodology/#preprocesamiento-de-imagenes","text":"","title":"Preprocesamiento de im\u00e1genes"},{"location":"methodology/#sentinel-2","text":"Para poder utilizar las im\u00e1genes multiespectrales de Sentinel-2 y las im\u00e1genes SAR de Sentinel-1 fue necesario aplicar una serie de pasos de calibraci\u00f3n. Dado que se descargaron escenas de nivel L1C para Sentinel-2, fue necesario ejecutar la herramienta de c\u00f3digo abierto sen2cor, provista por la plataforma de la ESA. Este proceso realiza las correcciones atmosf\u00e9ricas y geom\u00e9tricas de las escenas y genera una versi\u00f3n de las im\u00e1genes a nivel bottom-of-atmosphere, designado como nivel L2A. Tambi\u00e9n genera una m\u00e1scara de nubes, que luego utilizamos para descartar aquellos p\u00edxeles de la imagen que est\u00e1n cubiertos de nubes. Estos p\u00edxeles no son v\u00e1lidos para el modelo, y ser\u00e1n reemplazados por los de la imagen de Sentinel-1 del per\u00edodo correspondiente. Para generar el mosaico, aplicamos la herramienta de c\u00f3digo abierto sen2mosaic, para Python.","title":"Sentinel-2"},{"location":"methodology/#sentinel-1","text":"Para trabajar con las im\u00e1genes de este sensor para la detecci\u00f3n de edificaciones y cambios en la cobertura del suelo, se descargaron escenas del producto GRD (Ground Range Detected) donde los valores de los p\u00edxeles representan la magnitud detectada. La resoluci\u00f3n espacial de estas im\u00e1genes es de aproximadamente 10m por p\u00edxel. Luego de descargar los productos se procede con la calibraci\u00f3n radiom\u00e9trica, que permite calcular el valor sigma0 de las bandas de polarizaci\u00f3n VV y VH. Al hacer esta calibraci\u00f3n, tambi\u00e9n se utiliza el DEM de SRTM para ortorectificar las im\u00e1genes. El segundo paso es la eliminaci\u00f3n del ruido Speckle con la aplicaci\u00f3n de un filtro espec\u00edfico para este tipo de ruido, caracter\u00edstico en las im\u00e1genes SAR. El siguiente paso que realizamos es calcular la proporci\u00f3n VV/VH a partir de las bandas VV y HH, que es un atributo que utiliza el modelo de cobertura de suelo. Finalmente se concatenan las 3 bandas en una sola imagen, y se corregistran de a pares de escenas con la herramienta AROSICS. Este paso es necesario para luego poder generar el mosaico en base a todas las escenas descargadas. Finalmente se recorta la imagen con la capa vectorial del AOI.","title":"Sentinel-1"},{"location":"methodology/#armado-del-dataset","text":"Los datasets de entrenamiento y evaluaci\u00f3n del modelo se definieron de la siguiente manera: Im\u00e1genes de todo un a\u00f1o completo, desde noviembre del 2018 a noviembre del 2019 inclusive. Mosaicos bimestrales, de tres (3) per\u00edodos distintos de ese a\u00f1o. Cuatro (4) \u00e1reas definidas Para cada mosaico de entrenamiento hay un mosaico de evaluaci\u00f3n exactamente dos meses despu\u00e9s, cubriendo as\u00ed todos los per\u00edodos del a\u00f1o. A continuaci\u00f3n se detallan los rangos de fecha utilizados para los datasets: Train 2018-11 al 2018-12 2019-03 al 2019-04 2019-07 al 2019-08 Test 2019-01 al 2019-02 2019-05 al 2019-06 2019-09 al 2019-10 Las bandas utilizadas de cada sensor fueron las siguientes: * Sentinel-2 : 10 bandas multiespectrales - B2 (490 nm), B3 (560 nm), B4 (665 nm) y B8 (842 nm), de 10m por p\u00edxel - B5 (705 nm), B6 (740 nm), B7 (783 nm), B8a (865 nm), B11 (1610 nm) y B12 (2190 nm), de 20m por p\u00edxel * Sentinel-1 : 3 bandas: - VV, VH - VV/HH * SRTM : DEM, altitud en msnm Para cada banda, se extrajeron los siguientes atributos utilizando la herramienta de c\u00f3digo abierto Orfeo Toolbox: Estad\u00edsticas locales : 4 momentos estad\u00edsticos en la vecindad de cada pixel Media Varianza Skewness (asimetr\u00eda) Curtosis Atributos de textura de Haralick : 8 atributos locales Energy (texture uniformity) Entropy (measure of randomness of intensity image) Correlation (how correlated a pixel is to its neighborhood) Inverse Difference Moment (measures the texture homogeneity) Inertia (intensity contrast between a pixel and its neighborhood) Cluster Shade Cluster Prominence Haralick Correlation","title":"Armado del dataset"},{"location":"methodology/#entrenamiento-preliminar-y-evaluacion","text":"Para evaluar la importancia de las bandas seleccionadas y los atributos extra\u00eddos, se entren\u00f3 un modelo de cobertura de suelo para las 4 \u00e1reas asignadas. Se anotaron pol\u00edgonos para las siguientes clases: - Suelo de loma natural - Suelo de loma artificial / movimiento de suelo - \u00c1rea urbana - Suelo desnudo - Vegetaci\u00f3n / campo - Agua Para cada uno de los mosaicos de cada per\u00edodo, se cort\u00f3 el raster a medida con la uni\u00f3n de las extensiones de las 4 \u00e1reas (para que los subsiguientes procesos sean m\u00e1s eficientes en memoria y c\u00f3mputo), y se extrajeron los atributos de cada una de estas im\u00e1genes. Se generaron 3 Shapefiles como resultado (1 por cada per\u00edodo), que fueron fusionados para obtener un \u00fanico Shapefile de puntos con atributos. Finalmente, se utiliz\u00f3 Orfeo Toolbox para entrenar un random forest a partir de las anotaciones, y los atributos extra\u00eddos anteriormente. Luego de ajustar los hiperpar\u00e1metros del modelo, se alcanz\u00f3 un kappa de 0.89. A continuaci\u00f3n se muestran las m\u00e9tricas y matrices de confusi\u00f3n de la mejor ejecuci\u00f3n. Par\u00e1metros: Profundidad: 9 \u00c1rboles: 175 Predicted list size : 92358 ValidationLabeledListSample size : 92358 Training performances: Confusion matrix (rows = reference labels, columns = produced labels): 1 2 3 4 5 6 1 14316 798 255 24 0 0 2 1035 12051 2082 105 0 120 3 90 978 13623 324 42 336 4 9 402 1581 13362 21 18 5 0 0 0 0 15393 0 6 0 0 129 12 6 15246 Precision of class [1] vs all: 0.926602 Recall of class [1] vs all: 0.930033 F-score of class [1] vs all: 0.928314 Precision of class [2] vs all: 0.846932 Recall of class [2] vs all: 0.782888 F-score of class [2] vs all: 0.813652 Precision of class [3] vs all: 0.770968 Recall of class [3] vs all: 0.885013 F-score of class [3] vs all: 0.824063 Precision of class [4] vs all: 0.96637 Recall of class [4] vs all: 0.868057 F-score of class [4] vs all: 0.914579 Precision of class [5] vs all: 0.995537 Recall of class [5] vs all: 1 F-score of class [5] vs all: 0.997764 Precision of class [6] vs all: 0.969847 Recall of class [6] vs all: 0.99045 F-score of class [6] vs all: 0.98004 Global performance, Kappa index: 0.891288 A continuaci\u00f3n se observan las cuatro \u00e1reas sobre un mosaico de Sentinel-2 y el resultado del clasificador correspondiente.","title":"Entrenamiento preliminar y evaluaci\u00f3n"},{"location":"methodology/#modelo-de-deteccion-de-vegetacion","text":"","title":"Modelo de detecci\u00f3n de vegetaci\u00f3n"},{"location":"methodology/#fuentes-de-datos_1","text":"El modelo de detecci\u00f3n de vegetaci\u00f3n utiliza im\u00e1genes satelitales MODIS, en particular el producto MOD13Q1.006, que cuenta con resoluci\u00f3n espacial de 250m y temporal de 16 d\u00edas. Se cuenta con una imagen por mes, desde enero 2014 a noviembre 2019. Las im\u00e1genes MODIS se complementan con el modelo de elevaci\u00f3n digital (DEM) del SRTM, mencionado anteriormente. Adem\u00e1s se cuenta con la definici\u00f3n del \u00e1rea de an\u00e1lisis propuesta por el equipo de EbA Lomas. Para definir la misma, en el \u00e1mbito de las provincias de Lima y Callao, se consider\u00f3 lo siguiente: \u00c1reas localizadas entre los 200 y 1800 msnm conforme al art\u00edculo de Le\u00f3n (2017). Las curvas de nivel fueron extra\u00eddas de la carta nacional 1:100 000 del Instituto Geogr\u00e1fico Nacional. Exclusi\u00f3n de zonas con presencia de campos agr\u00edcolas, forestaci\u00f3n densa de laderas aleda\u00f1as a zonas urbanas y/o agr\u00edcolas, empleando una imagen Spot (2017). Exclusi\u00f3n de zonas urbanas consolidadas con un buffer de 30m de acuerdo al INEI (2016).","title":"Fuentes de datos"},{"location":"methodology/#metodologia_1","text":"En primer lugar se recortaron las im\u00e1genes MODIS y SRTM al \u00e1rea de estudio propuesta por el equipo de EbA Lomas. Partiendo de los datos MODIS del \u00e1rea a monitorear, se determin\u00f3 mediante un umbral NDVI aquellos pixeles que representaban vegetaci\u00f3n. Dicho umbral fue definido en 0.2, tomando como fuente al art\u00edculo de Le\u00f3n (2017), donde se indica que un valor inferior a 0.2 representa suelo desnudo. Luego con las im\u00e1genes SRTM del \u00e1rea a monitorear, se determin\u00f3 la presencia o no de las Lomas. Tomando como Lomas los lugares con altura entre 200 y 1800 msnm. Finalmente consideramos como informaci\u00f3n relevante para la capa verde, aquellos p\u00edxeles que cumplen ambas condiciones, es decir presentan tanto vegetaci\u00f3n como las condiciones que definen a la Loma. Se genera como resultado, para cada mes, dos tipos de capas r\u00e1ster: * Rango NDVI: resultado complementario, donde se discretizan los valores NDVI en 4 rangos. * M\u00e1scara Verde: un valor 0 o 1 para cada p\u00edxel, seg\u00fan cumple las condiciones mencionadas anteriormente. * M\u00e1scara de Nubes: determina si un pixel fue considerado como nube en el producto original de MODIS. Luego de un an\u00e1lisis posterior de los resultados, se incluy\u00f3 un paso de postprocesamiento que aplica una m\u00e1scara conformada por pol\u00edgonos, con el objetivo de excluir vegetaci\u00f3n no relacionada al ecosistema de Lomas (por ejemplo: zonas agr\u00edcolas, urbanas, periurbanas). Por otro lado, debido a que la resoluci\u00f3n del producto MODIS es muy baja, en determinados casos se terminan incluyendo \u00e1reas con vegetaci\u00f3n en los bordes de zonas agr\u00edcolas. Con el fin de resolver este problema, se aplic\u00f3 un buffer para reducir el \u00e1rea de inclusi\u00f3n en los bordes y evitar este problema. La m\u00e1scara de nubes se genera extrayendo los p\u00edxeles catalogados como \"nube\" en el dataset Pixel reliability del producto MOD13Q1. Para m\u00e1s informaci\u00f3n acerca del producto MOD13Q1 se recomienda leer la Guia de Usuario .","title":"Metodolog\u00eda"},{"location":"usage/","text":"Gu\u00eda de Uso \u00b6 En esta secci\u00f3n se describen las diferentes vistas que conforman el frontend de la plataforma, y de qu\u00e9 manera se pueden utilizar las herramientas provistas para visualizar y analizar los resultados de los procesos autom\u00e1ticos aplicados sobre im\u00e1genes satelitales y de las estaciones meteorol\u00f3gicas. Este texto est\u00e1 dirigido tanto para usuarios an\u00f3nimos, como para usuarios registrados y aquellos con el rol de administrador. Inicio \u00b6 En la p\u00e1gina de inicio se listan diferentes componentes que forman parte de la plataforma. Desde aqu\u00ed se puede acceder a los mapas del m\u00f3dulo de Observaci\u00f3n Terrestre, como el mapa de Cobertura Verde o el mapa de Cobertura de Loma Perdida , y por otro lado, al Mapa y el Dashboard del m\u00f3dulo de Estaciones Meteorol\u00f3gicas. Observaci\u00f3n terrestre \u00b6 Cobertura Verde \u00b6 El aplicativo de mapa de cobertura verde presenta la capa de cobertura de vegetaci\u00f3n del ecosistema de lomas, basada en el producto de MODIS de \u00edndices de vegetaci\u00f3n (MOD13Q1). En la esquina superior izquierda se encuentra el control de Filtro, que permite filtrar los resultados de la serie de tiempo para un \u00e1mbito y un rango de fechas espec\u00edfico: Desde el selector de Tipo de \u00c1mbito se puede seleccionar un tipo de \u00e1mbito. Al seleccionar uno, en el mapa se actualizar\u00e1 la capa de \u00e1mbitos del tipo seleccionado. Tambi\u00e9n se puede ajustar la fecha de comienzo y fin de la serie de tiempo. Por defecto, se toma la primer fecha y \u00faltima fecha con datos cargados en la base de datos. Por defecto se visualiza la capa NDVI, pero tambi\u00e9n es posible visualizar en simultaneo una m\u00e1scara de vegetaci\u00f3n, resultado de la umbralizaci\u00f3n de la capa NDVI, ( Vegetation mask ) y una m\u00e1scara de nubes ( Cloud Mask ), extra\u00edda del mismo producto de MODIS. Estas capas se pueden activar o desactivar haciendo clic en el \u00edcono de Capas en la esquina inferior izquierda, y en cada casillero. Tambi\u00e9n es posible ajustar la opacidad de cada capa ajustando el control deslizante al lado del nombre de la capa. Debajo del \u00edcono de Capas, se encuentra el control de Selecci\u00f3n de Per\u00edodos, que permite seleccionar una fecha en particular, para visualizar las capas de ese per\u00edodo en el mapa. Filtro vs. selector de fechas Esta selecci\u00f3n de fecha s\u00f3lo afecta a las capas visualizadas en el mapa, no a la serie de tiempo. Para ajustar las fechas de la serie de tiempo, debe hacerlo desde el control de Filtro. Cobertura de Loma Perdida \u00b6 La vista de cobertura de Loma Perdida funciona de manera similar al mapa de Cobertura Verde. Las capas disponibles en este caso son: Loss mask : M\u00e1scara de loma perdida. Resultado del producto de clasificaci\u00f3n de cobertura de loma perdida. Sentinel-1 : Imagen en color falso del mosaico de Sentinel-1 para el per\u00edodo actual. Las bandas utilizadas fueron VV, VH y la proporci\u00f3n VV/VH como rojo, verde y azul respectivamente. Sentinel-2 : Imagen en color verdadero del mosaico de Sentinel-2 para el per\u00edodo actual. Fusi\u00f3n de vistas Pr\u00f3ximamente esta vista ser\u00e1 fusionada junto con la de Detecci\u00f3n de Cambios en una \u00fanica vista Detecci\u00f3n de Cambios en Lomas. Detecci\u00f3n de Objetos \u00b6 En esta vista se visualiza el producto del modelo de detecci\u00f3n de objetos para escenas del sat\u00e9lite PeruSat-1. Este producto consiste en una capa vectorial, donde se localizan objetos de inter\u00e9s, relacionados a actividad no monitoreada e invasi\u00f3n de tierras sobre las Lomas. Objetos de inter\u00e9s Por el momento el modelo detecta techos de viviendas informales . Se est\u00e1 desarrollando un nuevo modelo de detecci\u00f3n con otros objetos y patrones visuales. Fusi\u00f3n de vistas Pr\u00f3ximamente esta vista ser\u00e1 fusionada junto con la de Covertura de Loma perdida en una \u00fanica vista Detecci\u00f3n de Cambios en Lomas. Estaciones Meteorol\u00f3gicas \u00b6 La plataforma incluye un m\u00f3dulo de estaciones hidrometeorol\u00f3gicas ligeras, donde se almacenan, analizan y visualizan mediciones recolectadas por sensores de clima acoplados a un recolector de neblina est\u00e1ndar, instalados en diferentes localidades o sitios del ecosistema. Estos sensores autom\u00e1ticos env\u00edan a trav\u00e9s de un nodo Lorawan la informaci\u00f3n en tiempo real a la plataforma. Mapa \u00b6 Desde el frontend se pueden acceder a un mapa de Sitios, donde se presentan todos los sitios en donde se instalaron estaciones y se recolectaron datos en la historia, y se ubican con con marcadores en el mapa. Al cargar, el mapa se centra de tal manera de poder mostrar todos los marcadores en pantalla. Si desea buscar un sitio por nombre o por nombre del lugar donde est\u00e1 instalado, haga clic en el \u00edcono Buscar (\"lupa\"), en la esquina superior izquierda. Se desplegar\u00e1 al costado izquierdo un buscador donde podr\u00e1 ingresar parte del nombre del sitio. Los resultados aparecer\u00e1n automaticamente en la lista debajo del cuadro de entrada. Si hace clic sobre un marcador en el mapa, se abrir\u00e1 una ventana indicando el nombre y c\u00f3digo de la estaci\u00f3n configurada, y su lugar. Tambi\u00e9n se mostrar\u00e1, a modo de previsualizaci\u00f3n, un gr\u00e1fico de serie de tiempo de un par\u00e1metro de los sensores de la estaci\u00f3n asociada. Puede cambiar de par\u00e1metro haciendo clic sobre el selector que se encuentra arriba del gr\u00e1fico. Haciendo clic en el bot\u00f3n Dashboard podr\u00e1 ingresar al dashboard de ese sitio seleccionado. Dashboard \u00b6 En esta vista se presentan una serie de gr\u00e1ficos de series de tiempo para cada par\u00e1metro recolectado por los sensores de la estaci\u00f3n asociada a un sitio en particular. Por ejemplo, en los sensores instalados actualmente, se est\u00e1n recolectando estos par\u00e1metros: Altitud (msnm) Temperatura de Ambiente (\u00b0C) Presi\u00f3n Atmosf\u00e9rica (mbar) Temperatura Interna (\u00b0C) Material Particulado (PM1.0) Material Particulado (PM2.5) Material Particulado (PM4.0) Material Particulado (PM10.0) Humedad Relativa (%) Conteo de Tipping Bucket Velocidad del Viento (m/s) Direcci\u00f3n del Viento (grados) En la esquina superior derecha se encuentran dos controles de filtrado, que determinan qu\u00e9 datos se graficar\u00e1n en el dashboard: sitio y tiempo . Sitio \u00b6 Este control filtra las mediciones para un sitio en particular. Haciendo clic, se abrir\u00e1 una ventana con un selector de sitios. Al seleccionarla, se actualizaran automaticamente todos los gr\u00e1ficos. Tiempo \u00b6 Este control maneja varios aspectos del filtrado y visualizaci\u00f3n de las mediciones en el dashboard. Posee dos modos de functionamento: * Tiempo Real : Toma las mediciones hace cierta cantidad de tiempo hasta ahora. En este modo los datos en la p\u00e1gina se actualizan autom\u00e1ticamente, sin necesidad de refrescarla. Hist\u00f3rico : Toma las mediciones y las filtra en un rango de tiempo (desde-hasta). Permite trabajar con datos hist\u00f3ricos. Ambos modos de operaci\u00f3n tienen dos controles en com\u00fan que determinan su funcionamiento: Intervalo de agrupaci\u00f3n : Define el interval en el que se agrupar\u00e1n los datos. Por ejemplo: minuto, hora, d\u00eda, semana, mes, a\u00f1o. Funci\u00f3n de agregaci\u00f3n de tiempo : Define la funci\u00f3n que se aplicar\u00e1 a cada grupo de mediciones por intervalo. Por ejemplo: promedio, m\u00e1ximo, m\u00ednimo, etc. Tabla \u00b6 Esta vista es muy similar al dashboard, dado que se presentan los datos de mediciones de un sitio en particular, pero en formato de tabla. A diferencia del dashboard, la tabla tiene como columna cada uno de los par\u00e1metros, y como fila cada medici\u00f3n Posee los mismos controles de filtrado que el dashboard (control de Sitio y de Tiempo), y en todo momento se puede dirigir de la vista de tabla al dashboard y vice versa, mantiendo la configuraci\u00f3n de filtro, haciendo clic en Dashboard , en la esquina superior izquierda. Por otro lado, haciendo clic en Descargar , se podr\u00e1 descargar la tabla en formato CSV (valores separados por coma), documento que puede ser abierto en otras aplicaciones como planillas de c\u00e1lculo. Usuarios \u00b6 Aquellos usuarios que hayan sido invitados y registrados en la plataforma por un administrador, podr\u00e1n acceder a un panel de usuario y al sistema de Alertas. Puede iniciar sesi\u00f3n en todo momento hacinedo clic en el bot\u00f3n Iniciar Sesi\u00f3n , que se encuentra en la esquina superior derecha. Luego ingrese su nombre de usuario y contrase\u00f1a, y haga clic en Ingresar . Si no recuerda su contrase\u00f1a, puede reestablecerla haciendo clic en Solicitar una nueva e ingresando la direcci\u00f3n de email con la que fue registrado. Al aceptar, se le enviar\u00e1 a su casilla un email con instrucciones para reestablecer su contrase\u00f1a. Una vez que est\u00e1 autenticado, notar\u00e1 que en el lugar donde antes estaba el bot\u00f3n Iniciar sesi\u00f3n ahora hay dos \u00edconos: Alertas (campana): Indica nuevas alertas (no vistas), y muestra una lista de las \u00faltimas 5 notificaciones generadas. Perfil : Permite acceder al panel de usuario, al perfil de usuario y cerrar la sesi\u00f3n. Reglas \u00b6 El sistema de alertas y notificaci\u00f3n de incidentes se basa en un conjunto de reglas definidas por el usuario. El usuario debe definir reglas para poder monitorear cambios de inter\u00e9s. De esta manera, el sistema no toma decisiones por su cuenta, si no que solamente informa cuando se captura una medici\u00f3n anormal seg\u00fan el criterio del usuario y permite facilmente hacer una evaluaci\u00f3n posterior acerca de los cambios registrados. Dado las naturalezas de los datos que se procesan y cargan en la plataforma, tnato dle m\u00f3dulo de observaci\u00f3n terrestre (productos del procesamiento de im\u00e1genes satelitales) y del m\u00f3dulo de estaciones meteorol\u00f3gicas (mediciones de sensores terrestres), el sistema define 3 tipos de reglas: Reglas de par\u00e1metro Reglas de tipo de \u00e1mbito Reglas de \u00e1mbito A continuaci\u00f3n se describen cada uno de ellos, y se detalla como el usuario puede listar, definir, modificar o eliminar reglas. Reglas de Par\u00e1metro \u00b6 Las Reglas de Par\u00e1metro aplican a cambios relacionados a un par\u00e1metro de una estaci\u00f3n meteorol\u00f3gica. Una regla de par\u00e1metro se define con los siguientes atributos: Estaci\u00f3n : La estaci\u00f3n sobre la cual aplica la regla. Este campo puede ser vac\u00edo, en cuyo caso se aplicar\u00e1 a cualquier estaci\u00f3n. Par\u00e1metro : El par\u00e1metro sobre el cual aplica la regla. Valor m\u00ednimo y m\u00e1ximo : Define el rango de valores m\u00e1ximos permitidos para el par\u00e1metro de la estaci\u00f3n. Si se observa una medici\u00f3n por fuera de esta rango, se crear\u00e1 una alerta. \u00bfEs absoluto? : Determina si el rango v\u00e1lido de valores es en t\u00e9rminos absolutos o relativos con respecto a la medici\u00f3n anterior (del mismo par\u00e1metro y estaci\u00f3n). Reglas de \u00c1mbito \u00b6 Las Reglas de \u00c1mbito aplican a cambios de cobertura en un \u00e1mbito en particular. Una regla de \u00e1mbito se define con los siguientes atributos: \u00c1mbito : El \u00e1mbito sobre el cual aplica la regla. Este campo puede ser vac\u00edo, en cuyo caso se aplicar\u00e1 a cualquier \u00e1mbito. Tipo de Cobertura : El tipo de cobertura en el que aplica la regla. Por el momento hay dos opciones: Vegetaci\u00f3n en Lomas (cmabios de Cobertura Verde) y P\u00e9rdida de Loma (cambios de Cobertura de Loma Perdida). Tambi\u00e9n es posible seleccionar [Cualquiera] para que aplique sobre cualquiera de los dos tipos. Tipo de Cambio : Determina si el rango de valores es en t\u00e9rminos de \u00c1rea o Porcentaje de \u00e1rea. Utilizar Porcentaje permite definir una regla en t\u00e9rminos de area relativos a la superficie de los \u00e1mbitos. Valor m\u00ednimo y m\u00e1ximo : Define el rango de valores permitidos. Si el tipo de cambio es Area, los valores representan hect\u00e1reas. Si el tipo de cambio es Porcentaje, los valores son porcentajes (entre 0 y 100). Reglas de Tipo de \u00c1mbito \u00b6 Las Reglas de Tipo de \u00c1mbito aplican a cambios de cobertura en todos los \u00e1mbitos de un tipo de \u00e1mbitos. Una regla de tipo de \u00e1mbito se define con los siguientes atributos: Tipo de \u00c1mbito : El tipo de \u00e1mbito sobre el cual aplica la regla. Este campo puede ser vac\u00edo, en cuyo caso se aplicar\u00e1 a cualquier tipo de \u00e1mbito. Tipo de Cobertura : El tipo de cobertura en el que aplica la regla. Por el momento hay dos opciones: Vegetaci\u00f3n en Lomas (cmabios de Cobertura Verde) y P\u00e9rdida de Loma (cambios de Cobertura de Loma Perdida). Tambi\u00e9n es posible seleccionar [Cualquiera] para que aplique sobre cualquiera de los dos tipos. Tipo de Cambio : Determina si el rango de valores es en t\u00e9rminos de \u00c1rea o Porcentaje de \u00e1rea. Utilizar Porcentaje permite definir una regla en t\u00e9rminos de area relativos a la superficie de los \u00e1mbitos. Valor m\u00ednimo y m\u00e1ximo : Define el rango de valores permitidos. Si el tipo de cambio es Area, los valores representan hect\u00e1reas. Si el tipo de cambio es Porcentaje, los valores son porcentajes (entre 0 y 100). Alertas \u00b6 Cada vez que se carguen mediciones nuevas en la base de datos, se ejecuta el motor de reglas, para determinar si se deben generar nuevas alertas. En este momento, las condiciones para que se dispare el motor de reglas son las siguientes: Se proces\u00f3 y carg\u00f3 un nuevo producto del modelo de Cobertura Verde. Frecuencia : Una vez por mes Se proces\u00f3 y carg\u00f3 un nuevo producto del modelo de Cobertura de Loma Perdida Frecuencia : Una vez por mes Se proces\u00f3 y carg\u00f3 un nuevo producto del modelo de Detecci\u00f3n de Objetos Frecuencia : Depende de la frecuencia de los pedidos de escenas de PeruSat-1 a CONIDA. Se carg\u00f3 una nueva medici\u00f3n de una estaci\u00f3n meteorol\u00f3gica Frecuencia : Cada 15 minutos El motor de reglas recorre, para todos los usuarios, cada una de las reglas definidas, y verifica si la nueva medici\u00f3n rompe esa regla. Si esto sucede, se crea una alerta y se notifica. Las alertas generadas se listan en la secci\u00f3n Alertas del Panel de Usuario, donde se detalla la fecha en la que ocurri\u00f3 la notificaci\u00f3n, la regla afectada y una descripci\u00f3n de la causa de la alerta. A continuaci\u00f3n se describen diagramas de flujo acerca del funcionamiento del motor de reglas. Diagrama de verificaci\u00f3n de regla \u00b6 Este es un diagrama del algoritmo de verificaci\u00f3n de una regla en particular. El motor realiza este procedimiento para cada regla y usuario. graph TB; inicio([Inicio])-->esAbs{{es absoluto?}}; esAbs-- s\u00ed -->valAbs[Toma como valor <br />la medicion actual]; esAbs-- no -->valRel[Toma como valor <br />la diferencia <br />entre medicion actual y <br />medicion anterior]; valAbs-->esValMenorMin{{es valor menor <br />al m\u00ednimo valido?}}; valRel-->esValMenorMin; esValMenorMin-- s\u00ed -->crear[Crear alerta]; esValMenorMin-- no -->esValMayorMax[es valor mayor <br />al m\u00e1ximo v\u00e1lido?]; esValMayorMax-- s\u00ed -->crear; esValMayorMax-- no -->fin([Fin]); crear-->debeNotificar{{debe notificar por mail?}}; debeNotificar-- s\u00ed -->notificar[Enviar notificaci\u00f3n por mail]; debeNotificar-- no -->fin; notificar-->fin; Diagrama para reglas de par\u00e1metro \u00b6 Diagrama que describe como se filtran las mediciones para una regla de par\u00e1metro. graph LR; inicio([Inicio])-->todas{{en todas las estaciones?}}; todas-- s\u00ed -->fin([Fin]); todas-- no -->filtrar[Filtra por estaci\u00f3n <br />definida en regla]; filtrar-->fin; Diagrama para reglas de tipo de \u00e1mbito \u00b6 Diagrama que describe como se filtran las mediciones para una regla de tipo de \u00e1mbito. graph LR; inicio([Inicio])-->todos{{en todos los tipos de \u00e1mbito?}}; todos-- s\u00ed -->fin([Fin]); todos-- no -->filtrar[Filtra por tipo de \u00e1mbito <br />definido en regla]; filtrar-->fin; Diagrama para reglas de \u00e1mbito \u00b6 Diagrama que describe como se filtran las mediciones para una regla de \u00e1mbito. graph LR; inicio([Inicio])-->todos{{en todos los \u00e1mbitos?}}; todos-- s\u00ed -->fin([Fin]); todos-- no -->filtrar[Filtra por \u00e1mbito <br />definido en regla]; filtrar-->fin; Im\u00e1genes \u00b6 En la secci\u00f3n Im\u00e1genes del Panel de Usuario se listan las im\u00e1genes r\u00e1ster, producto de los procesos autom\u00e1ticos del m\u00f3dulo de observaci\u00f3n terrestre (cobertura verde, loma perdida, etc). En la tabla figura el per\u00edodo correspondiente al producto y el nombre de la imagen. Desde esta lista se pueden descargar en formato GeoTIFF hacinedo clic en el \u00edcono de Descarga. Tambi\u00e9n se puede obtener una URL del servidor XYZ de tiles , para poder incorporar esa imagen como capa en otras aplicaciones GIS, como QGIS o Leaflet. Perfil \u00b6 En la secci\u00f3n Perfil, el usuario puede: Modificar su direcci\u00f3n de e-mail Activar o desactivar el env\u00edo de notificaciones de alerta por e-mail Reestablecer la contrase\u00f1a Administradores \u00b6 Los administradores tienen la capacidad de registrar nuevos usuarios y administradores, revocar el acceso a usuarios existentes, administrar los \u00e1mbitos y las estaciones meteorol\u00f3gicas. Puede acceder al panel administrador de SatLomas ingresando aqu\u00ed: https://api.satlomas.pe.undp.org/admin Para entrar deber\u00e1 ingresar el mismo nombre de usuario y contrase\u00f1a con la que ingresa al panel de usuario de SatLomas. Panel de administraci\u00f3n \u00b6 Desde el panel de administraci\u00f3n podr\u00e1 acceder a los diferentes modelos de las aplicaciones internas de la plataforma. Muchas de ellas son de solo lectura ya que no est\u00e1n pensadas para ser modificadas desde el panel administador, pero a efectos de depuraci\u00f3n y testeo se mantuvieron. Usuarios \u00b6 Desde la secci\u00f3n Usuarios puede crear nuevos usuarios, modificar alguno existente o desactivarlo. Un usuario tiene 2 tipos de permisos: Activo : Determina si el usuario est\u00e1 activo o no. Puede desmarcar esta opcion sobre un usuario existente para desactivarlo en vez de borrarlo. Es staff : Indica si el usuario puede entrar al sitio de administrador. Un administrador tiene este casillero activado. En caso de querer registrar un nuevo usuario, deber\u00e1 escribir un nombre de usuario y una contrase\u00f1a. \u00c1mbitos \u00b6 En la secci\u00f3n de \u00c1mbitos ( Scopes ) se pueden listar, modificar, eliminar o agregar nuevos \u00e1mbitos. Al editar un \u00e1mbito, o crear uno nuevo, se puede asignar un nombre y tipo de \u00e1mbito, y dibujar sobre un mapa un multipol\u00edgono para la geometr\u00eda. Tambi\u00e9n es posible cargar un archivo vectorial en formato GeoJSON. Este archivo vectorial debe tener un \u00fanico feature con un multipol\u00edgono o pol\u00edgono de geometr\u00eda. Estaciones meteorol\u00f3gicas \u00b6 En la secci\u00f3n de Estaciones Meteorol\u00f3gicas ( Stations ) se pueden listar, modificar, eliminar o agregar nuevas estaciones meteorol\u00f3gicas (Station) y nuevos sitios (Site). Al momento de crear un nuevo sitio, es necesario asegurarse que la estaci\u00f3n est\u00e9 creada primero. Cada estaci\u00f3n tiene un c\u00f3digo un\u00edvoco que las identifica. La plataforma solamente cargar\u00e1 los datos que recibe si reconoce el c\u00f3digo, dado que los datos se asocian exactamente a una estaci\u00f3n. El c\u00f3digo ( code ) de la estaci\u00f3n debe coincidir con el c\u00f3digo asignado a los sensores al momento de la carga de mediciones. Tambi\u00e9n se incluye un campo de metadatos en formato JSON, en caso de que sea necesario guardar informaci\u00f3n externa a la plataforma. Al editar o crear un Sitio, se le debe asignar un nombre, las coordenadas geogr\u00e1ficas (en proyecci\u00f3n WGS84), y opcionalmente asociarlo a una estaci\u00f3n cargada. Esta asociaci\u00f3n puede hacerle luego en una edici\u00f3n posterior. Tambi\u00e9n existe la posibilidad de agregarle atributos opcionales relacionados con el sitio. Traslado de estaciones \u00b6 Dado que la estaciones pueden ser trasladadas de un sitio a otro, la plataforma ofrece un mecanismo que permite realizar el traslado, sin p\u00e9rdida de continuidad y consistencia de los datos a lo largo del tiempo. Suponiendo que se quiere trasladar una estaci\u00f3n del sitio \"A\" al sitio \"B\", a modo de ejemplo se proceder\u00eda de la siguiente manera: Se desconecta y desacopla la estaci\u00f3n ubicada en el sitio A En el administrador, se edita el sitio \"A\" y se desasocia la estaci\u00f3n. Este paso se realiza para que, al momento de encender la estaci\u00f3n ya ubicado en el sitio B, no se carguen erroneamente datos asociados al sitio A. Se traslada la estaci\u00f3n al sitio B. En el administrador, se crea el sitio B (si no exist\u00eda), y se asocia la estaci\u00f3n al sitio B. Se enciende la estaci\u00f3n, ya conectada a la red LoraWan. Es importante asegurarse que la estaci\u00f3n est\u00e9 desasociada del sitio original antes del traslado, y por otro lado, que la estaci\u00f3n ya est\u00e9 asociada al sitio nuevo antes de volver a conectarse. De esta manera, se podr\u00e1 asegurar que los datos est\u00e9n cargados correctamente y no haya p\u00e9rdida de informaci\u00f3n durante el proceso. En caso de interrupciones de conectividad o de energ\u00eda en las estaciones, la plataforma no se ver\u00e1 afectada y volver\u00e1 a recolectar datos autom\u00e1ticamente. Auditor\u00eda \u00b6 La plataforma tiene integrado un sistema de auditor\u00eda para todas las acciones realizadas por usuarios y por los procesos autom\u00e1ticos. Podr\u00e1 consultarla yendo a la Entradas de registro (en Audit Log ).","title":"Gu\u00eda de Uso"},{"location":"usage/#guia-de-uso","text":"En esta secci\u00f3n se describen las diferentes vistas que conforman el frontend de la plataforma, y de qu\u00e9 manera se pueden utilizar las herramientas provistas para visualizar y analizar los resultados de los procesos autom\u00e1ticos aplicados sobre im\u00e1genes satelitales y de las estaciones meteorol\u00f3gicas. Este texto est\u00e1 dirigido tanto para usuarios an\u00f3nimos, como para usuarios registrados y aquellos con el rol de administrador.","title":"Gu\u00eda de Uso"},{"location":"usage/#inicio","text":"En la p\u00e1gina de inicio se listan diferentes componentes que forman parte de la plataforma. Desde aqu\u00ed se puede acceder a los mapas del m\u00f3dulo de Observaci\u00f3n Terrestre, como el mapa de Cobertura Verde o el mapa de Cobertura de Loma Perdida , y por otro lado, al Mapa y el Dashboard del m\u00f3dulo de Estaciones Meteorol\u00f3gicas.","title":"Inicio"},{"location":"usage/#observacion-terrestre","text":"","title":"Observaci\u00f3n terrestre"},{"location":"usage/#cobertura-verde","text":"El aplicativo de mapa de cobertura verde presenta la capa de cobertura de vegetaci\u00f3n del ecosistema de lomas, basada en el producto de MODIS de \u00edndices de vegetaci\u00f3n (MOD13Q1). En la esquina superior izquierda se encuentra el control de Filtro, que permite filtrar los resultados de la serie de tiempo para un \u00e1mbito y un rango de fechas espec\u00edfico: Desde el selector de Tipo de \u00c1mbito se puede seleccionar un tipo de \u00e1mbito. Al seleccionar uno, en el mapa se actualizar\u00e1 la capa de \u00e1mbitos del tipo seleccionado. Tambi\u00e9n se puede ajustar la fecha de comienzo y fin de la serie de tiempo. Por defecto, se toma la primer fecha y \u00faltima fecha con datos cargados en la base de datos. Por defecto se visualiza la capa NDVI, pero tambi\u00e9n es posible visualizar en simultaneo una m\u00e1scara de vegetaci\u00f3n, resultado de la umbralizaci\u00f3n de la capa NDVI, ( Vegetation mask ) y una m\u00e1scara de nubes ( Cloud Mask ), extra\u00edda del mismo producto de MODIS. Estas capas se pueden activar o desactivar haciendo clic en el \u00edcono de Capas en la esquina inferior izquierda, y en cada casillero. Tambi\u00e9n es posible ajustar la opacidad de cada capa ajustando el control deslizante al lado del nombre de la capa. Debajo del \u00edcono de Capas, se encuentra el control de Selecci\u00f3n de Per\u00edodos, que permite seleccionar una fecha en particular, para visualizar las capas de ese per\u00edodo en el mapa. Filtro vs. selector de fechas Esta selecci\u00f3n de fecha s\u00f3lo afecta a las capas visualizadas en el mapa, no a la serie de tiempo. Para ajustar las fechas de la serie de tiempo, debe hacerlo desde el control de Filtro.","title":"Cobertura Verde"},{"location":"usage/#cobertura-de-loma-perdida","text":"La vista de cobertura de Loma Perdida funciona de manera similar al mapa de Cobertura Verde. Las capas disponibles en este caso son: Loss mask : M\u00e1scara de loma perdida. Resultado del producto de clasificaci\u00f3n de cobertura de loma perdida. Sentinel-1 : Imagen en color falso del mosaico de Sentinel-1 para el per\u00edodo actual. Las bandas utilizadas fueron VV, VH y la proporci\u00f3n VV/VH como rojo, verde y azul respectivamente. Sentinel-2 : Imagen en color verdadero del mosaico de Sentinel-2 para el per\u00edodo actual. Fusi\u00f3n de vistas Pr\u00f3ximamente esta vista ser\u00e1 fusionada junto con la de Detecci\u00f3n de Cambios en una \u00fanica vista Detecci\u00f3n de Cambios en Lomas.","title":"Cobertura de Loma Perdida"},{"location":"usage/#deteccion-de-objetos","text":"En esta vista se visualiza el producto del modelo de detecci\u00f3n de objetos para escenas del sat\u00e9lite PeruSat-1. Este producto consiste en una capa vectorial, donde se localizan objetos de inter\u00e9s, relacionados a actividad no monitoreada e invasi\u00f3n de tierras sobre las Lomas. Objetos de inter\u00e9s Por el momento el modelo detecta techos de viviendas informales . Se est\u00e1 desarrollando un nuevo modelo de detecci\u00f3n con otros objetos y patrones visuales. Fusi\u00f3n de vistas Pr\u00f3ximamente esta vista ser\u00e1 fusionada junto con la de Covertura de Loma perdida en una \u00fanica vista Detecci\u00f3n de Cambios en Lomas.","title":"Detecci\u00f3n de Objetos"},{"location":"usage/#estaciones-meteorologicas","text":"La plataforma incluye un m\u00f3dulo de estaciones hidrometeorol\u00f3gicas ligeras, donde se almacenan, analizan y visualizan mediciones recolectadas por sensores de clima acoplados a un recolector de neblina est\u00e1ndar, instalados en diferentes localidades o sitios del ecosistema. Estos sensores autom\u00e1ticos env\u00edan a trav\u00e9s de un nodo Lorawan la informaci\u00f3n en tiempo real a la plataforma.","title":"Estaciones Meteorol\u00f3gicas"},{"location":"usage/#mapa","text":"Desde el frontend se pueden acceder a un mapa de Sitios, donde se presentan todos los sitios en donde se instalaron estaciones y se recolectaron datos en la historia, y se ubican con con marcadores en el mapa. Al cargar, el mapa se centra de tal manera de poder mostrar todos los marcadores en pantalla. Si desea buscar un sitio por nombre o por nombre del lugar donde est\u00e1 instalado, haga clic en el \u00edcono Buscar (\"lupa\"), en la esquina superior izquierda. Se desplegar\u00e1 al costado izquierdo un buscador donde podr\u00e1 ingresar parte del nombre del sitio. Los resultados aparecer\u00e1n automaticamente en la lista debajo del cuadro de entrada. Si hace clic sobre un marcador en el mapa, se abrir\u00e1 una ventana indicando el nombre y c\u00f3digo de la estaci\u00f3n configurada, y su lugar. Tambi\u00e9n se mostrar\u00e1, a modo de previsualizaci\u00f3n, un gr\u00e1fico de serie de tiempo de un par\u00e1metro de los sensores de la estaci\u00f3n asociada. Puede cambiar de par\u00e1metro haciendo clic sobre el selector que se encuentra arriba del gr\u00e1fico. Haciendo clic en el bot\u00f3n Dashboard podr\u00e1 ingresar al dashboard de ese sitio seleccionado.","title":"Mapa"},{"location":"usage/#dashboard","text":"En esta vista se presentan una serie de gr\u00e1ficos de series de tiempo para cada par\u00e1metro recolectado por los sensores de la estaci\u00f3n asociada a un sitio en particular. Por ejemplo, en los sensores instalados actualmente, se est\u00e1n recolectando estos par\u00e1metros: Altitud (msnm) Temperatura de Ambiente (\u00b0C) Presi\u00f3n Atmosf\u00e9rica (mbar) Temperatura Interna (\u00b0C) Material Particulado (PM1.0) Material Particulado (PM2.5) Material Particulado (PM4.0) Material Particulado (PM10.0) Humedad Relativa (%) Conteo de Tipping Bucket Velocidad del Viento (m/s) Direcci\u00f3n del Viento (grados) En la esquina superior derecha se encuentran dos controles de filtrado, que determinan qu\u00e9 datos se graficar\u00e1n en el dashboard: sitio y tiempo .","title":"Dashboard"},{"location":"usage/#sitio","text":"Este control filtra las mediciones para un sitio en particular. Haciendo clic, se abrir\u00e1 una ventana con un selector de sitios. Al seleccionarla, se actualizaran automaticamente todos los gr\u00e1ficos.","title":"Sitio"},{"location":"usage/#tiempo","text":"Este control maneja varios aspectos del filtrado y visualizaci\u00f3n de las mediciones en el dashboard. Posee dos modos de functionamento: * Tiempo Real : Toma las mediciones hace cierta cantidad de tiempo hasta ahora. En este modo los datos en la p\u00e1gina se actualizan autom\u00e1ticamente, sin necesidad de refrescarla. Hist\u00f3rico : Toma las mediciones y las filtra en un rango de tiempo (desde-hasta). Permite trabajar con datos hist\u00f3ricos. Ambos modos de operaci\u00f3n tienen dos controles en com\u00fan que determinan su funcionamiento: Intervalo de agrupaci\u00f3n : Define el interval en el que se agrupar\u00e1n los datos. Por ejemplo: minuto, hora, d\u00eda, semana, mes, a\u00f1o. Funci\u00f3n de agregaci\u00f3n de tiempo : Define la funci\u00f3n que se aplicar\u00e1 a cada grupo de mediciones por intervalo. Por ejemplo: promedio, m\u00e1ximo, m\u00ednimo, etc.","title":"Tiempo"},{"location":"usage/#tabla","text":"Esta vista es muy similar al dashboard, dado que se presentan los datos de mediciones de un sitio en particular, pero en formato de tabla. A diferencia del dashboard, la tabla tiene como columna cada uno de los par\u00e1metros, y como fila cada medici\u00f3n Posee los mismos controles de filtrado que el dashboard (control de Sitio y de Tiempo), y en todo momento se puede dirigir de la vista de tabla al dashboard y vice versa, mantiendo la configuraci\u00f3n de filtro, haciendo clic en Dashboard , en la esquina superior izquierda. Por otro lado, haciendo clic en Descargar , se podr\u00e1 descargar la tabla en formato CSV (valores separados por coma), documento que puede ser abierto en otras aplicaciones como planillas de c\u00e1lculo.","title":"Tabla"},{"location":"usage/#usuarios","text":"Aquellos usuarios que hayan sido invitados y registrados en la plataforma por un administrador, podr\u00e1n acceder a un panel de usuario y al sistema de Alertas. Puede iniciar sesi\u00f3n en todo momento hacinedo clic en el bot\u00f3n Iniciar Sesi\u00f3n , que se encuentra en la esquina superior derecha. Luego ingrese su nombre de usuario y contrase\u00f1a, y haga clic en Ingresar . Si no recuerda su contrase\u00f1a, puede reestablecerla haciendo clic en Solicitar una nueva e ingresando la direcci\u00f3n de email con la que fue registrado. Al aceptar, se le enviar\u00e1 a su casilla un email con instrucciones para reestablecer su contrase\u00f1a. Una vez que est\u00e1 autenticado, notar\u00e1 que en el lugar donde antes estaba el bot\u00f3n Iniciar sesi\u00f3n ahora hay dos \u00edconos: Alertas (campana): Indica nuevas alertas (no vistas), y muestra una lista de las \u00faltimas 5 notificaciones generadas. Perfil : Permite acceder al panel de usuario, al perfil de usuario y cerrar la sesi\u00f3n.","title":"Usuarios"},{"location":"usage/#reglas","text":"El sistema de alertas y notificaci\u00f3n de incidentes se basa en un conjunto de reglas definidas por el usuario. El usuario debe definir reglas para poder monitorear cambios de inter\u00e9s. De esta manera, el sistema no toma decisiones por su cuenta, si no que solamente informa cuando se captura una medici\u00f3n anormal seg\u00fan el criterio del usuario y permite facilmente hacer una evaluaci\u00f3n posterior acerca de los cambios registrados. Dado las naturalezas de los datos que se procesan y cargan en la plataforma, tnato dle m\u00f3dulo de observaci\u00f3n terrestre (productos del procesamiento de im\u00e1genes satelitales) y del m\u00f3dulo de estaciones meteorol\u00f3gicas (mediciones de sensores terrestres), el sistema define 3 tipos de reglas: Reglas de par\u00e1metro Reglas de tipo de \u00e1mbito Reglas de \u00e1mbito A continuaci\u00f3n se describen cada uno de ellos, y se detalla como el usuario puede listar, definir, modificar o eliminar reglas.","title":"Reglas"},{"location":"usage/#reglas-de-parametro","text":"Las Reglas de Par\u00e1metro aplican a cambios relacionados a un par\u00e1metro de una estaci\u00f3n meteorol\u00f3gica. Una regla de par\u00e1metro se define con los siguientes atributos: Estaci\u00f3n : La estaci\u00f3n sobre la cual aplica la regla. Este campo puede ser vac\u00edo, en cuyo caso se aplicar\u00e1 a cualquier estaci\u00f3n. Par\u00e1metro : El par\u00e1metro sobre el cual aplica la regla. Valor m\u00ednimo y m\u00e1ximo : Define el rango de valores m\u00e1ximos permitidos para el par\u00e1metro de la estaci\u00f3n. Si se observa una medici\u00f3n por fuera de esta rango, se crear\u00e1 una alerta. \u00bfEs absoluto? : Determina si el rango v\u00e1lido de valores es en t\u00e9rminos absolutos o relativos con respecto a la medici\u00f3n anterior (del mismo par\u00e1metro y estaci\u00f3n).","title":"Reglas de Par\u00e1metro"},{"location":"usage/#reglas-de-ambito","text":"Las Reglas de \u00c1mbito aplican a cambios de cobertura en un \u00e1mbito en particular. Una regla de \u00e1mbito se define con los siguientes atributos: \u00c1mbito : El \u00e1mbito sobre el cual aplica la regla. Este campo puede ser vac\u00edo, en cuyo caso se aplicar\u00e1 a cualquier \u00e1mbito. Tipo de Cobertura : El tipo de cobertura en el que aplica la regla. Por el momento hay dos opciones: Vegetaci\u00f3n en Lomas (cmabios de Cobertura Verde) y P\u00e9rdida de Loma (cambios de Cobertura de Loma Perdida). Tambi\u00e9n es posible seleccionar [Cualquiera] para que aplique sobre cualquiera de los dos tipos. Tipo de Cambio : Determina si el rango de valores es en t\u00e9rminos de \u00c1rea o Porcentaje de \u00e1rea. Utilizar Porcentaje permite definir una regla en t\u00e9rminos de area relativos a la superficie de los \u00e1mbitos. Valor m\u00ednimo y m\u00e1ximo : Define el rango de valores permitidos. Si el tipo de cambio es Area, los valores representan hect\u00e1reas. Si el tipo de cambio es Porcentaje, los valores son porcentajes (entre 0 y 100).","title":"Reglas de \u00c1mbito"},{"location":"usage/#reglas-de-tipo-de-ambito","text":"Las Reglas de Tipo de \u00c1mbito aplican a cambios de cobertura en todos los \u00e1mbitos de un tipo de \u00e1mbitos. Una regla de tipo de \u00e1mbito se define con los siguientes atributos: Tipo de \u00c1mbito : El tipo de \u00e1mbito sobre el cual aplica la regla. Este campo puede ser vac\u00edo, en cuyo caso se aplicar\u00e1 a cualquier tipo de \u00e1mbito. Tipo de Cobertura : El tipo de cobertura en el que aplica la regla. Por el momento hay dos opciones: Vegetaci\u00f3n en Lomas (cmabios de Cobertura Verde) y P\u00e9rdida de Loma (cambios de Cobertura de Loma Perdida). Tambi\u00e9n es posible seleccionar [Cualquiera] para que aplique sobre cualquiera de los dos tipos. Tipo de Cambio : Determina si el rango de valores es en t\u00e9rminos de \u00c1rea o Porcentaje de \u00e1rea. Utilizar Porcentaje permite definir una regla en t\u00e9rminos de area relativos a la superficie de los \u00e1mbitos. Valor m\u00ednimo y m\u00e1ximo : Define el rango de valores permitidos. Si el tipo de cambio es Area, los valores representan hect\u00e1reas. Si el tipo de cambio es Porcentaje, los valores son porcentajes (entre 0 y 100).","title":"Reglas de Tipo de \u00c1mbito"},{"location":"usage/#alertas","text":"Cada vez que se carguen mediciones nuevas en la base de datos, se ejecuta el motor de reglas, para determinar si se deben generar nuevas alertas. En este momento, las condiciones para que se dispare el motor de reglas son las siguientes: Se proces\u00f3 y carg\u00f3 un nuevo producto del modelo de Cobertura Verde. Frecuencia : Una vez por mes Se proces\u00f3 y carg\u00f3 un nuevo producto del modelo de Cobertura de Loma Perdida Frecuencia : Una vez por mes Se proces\u00f3 y carg\u00f3 un nuevo producto del modelo de Detecci\u00f3n de Objetos Frecuencia : Depende de la frecuencia de los pedidos de escenas de PeruSat-1 a CONIDA. Se carg\u00f3 una nueva medici\u00f3n de una estaci\u00f3n meteorol\u00f3gica Frecuencia : Cada 15 minutos El motor de reglas recorre, para todos los usuarios, cada una de las reglas definidas, y verifica si la nueva medici\u00f3n rompe esa regla. Si esto sucede, se crea una alerta y se notifica. Las alertas generadas se listan en la secci\u00f3n Alertas del Panel de Usuario, donde se detalla la fecha en la que ocurri\u00f3 la notificaci\u00f3n, la regla afectada y una descripci\u00f3n de la causa de la alerta. A continuaci\u00f3n se describen diagramas de flujo acerca del funcionamiento del motor de reglas.","title":"Alertas"},{"location":"usage/#diagrama-de-verificacion-de-regla","text":"Este es un diagrama del algoritmo de verificaci\u00f3n de una regla en particular. El motor realiza este procedimiento para cada regla y usuario. graph TB; inicio([Inicio])-->esAbs{{es absoluto?}}; esAbs-- s\u00ed -->valAbs[Toma como valor <br />la medicion actual]; esAbs-- no -->valRel[Toma como valor <br />la diferencia <br />entre medicion actual y <br />medicion anterior]; valAbs-->esValMenorMin{{es valor menor <br />al m\u00ednimo valido?}}; valRel-->esValMenorMin; esValMenorMin-- s\u00ed -->crear[Crear alerta]; esValMenorMin-- no -->esValMayorMax[es valor mayor <br />al m\u00e1ximo v\u00e1lido?]; esValMayorMax-- s\u00ed -->crear; esValMayorMax-- no -->fin([Fin]); crear-->debeNotificar{{debe notificar por mail?}}; debeNotificar-- s\u00ed -->notificar[Enviar notificaci\u00f3n por mail]; debeNotificar-- no -->fin; notificar-->fin;","title":"Diagrama de verificaci\u00f3n de regla"},{"location":"usage/#diagrama-para-reglas-de-parametro","text":"Diagrama que describe como se filtran las mediciones para una regla de par\u00e1metro. graph LR; inicio([Inicio])-->todas{{en todas las estaciones?}}; todas-- s\u00ed -->fin([Fin]); todas-- no -->filtrar[Filtra por estaci\u00f3n <br />definida en regla]; filtrar-->fin;","title":"Diagrama para reglas de par\u00e1metro"},{"location":"usage/#diagrama-para-reglas-de-tipo-de-ambito","text":"Diagrama que describe como se filtran las mediciones para una regla de tipo de \u00e1mbito. graph LR; inicio([Inicio])-->todos{{en todos los tipos de \u00e1mbito?}}; todos-- s\u00ed -->fin([Fin]); todos-- no -->filtrar[Filtra por tipo de \u00e1mbito <br />definido en regla]; filtrar-->fin;","title":"Diagrama para reglas de tipo de \u00e1mbito"},{"location":"usage/#diagrama-para-reglas-de-ambito","text":"Diagrama que describe como se filtran las mediciones para una regla de \u00e1mbito. graph LR; inicio([Inicio])-->todos{{en todos los \u00e1mbitos?}}; todos-- s\u00ed -->fin([Fin]); todos-- no -->filtrar[Filtra por \u00e1mbito <br />definido en regla]; filtrar-->fin;","title":"Diagrama para reglas de \u00e1mbito"},{"location":"usage/#imagenes","text":"En la secci\u00f3n Im\u00e1genes del Panel de Usuario se listan las im\u00e1genes r\u00e1ster, producto de los procesos autom\u00e1ticos del m\u00f3dulo de observaci\u00f3n terrestre (cobertura verde, loma perdida, etc). En la tabla figura el per\u00edodo correspondiente al producto y el nombre de la imagen. Desde esta lista se pueden descargar en formato GeoTIFF hacinedo clic en el \u00edcono de Descarga. Tambi\u00e9n se puede obtener una URL del servidor XYZ de tiles , para poder incorporar esa imagen como capa en otras aplicaciones GIS, como QGIS o Leaflet.","title":"Im\u00e1genes"},{"location":"usage/#perfil","text":"En la secci\u00f3n Perfil, el usuario puede: Modificar su direcci\u00f3n de e-mail Activar o desactivar el env\u00edo de notificaciones de alerta por e-mail Reestablecer la contrase\u00f1a","title":"Perfil"},{"location":"usage/#administradores","text":"Los administradores tienen la capacidad de registrar nuevos usuarios y administradores, revocar el acceso a usuarios existentes, administrar los \u00e1mbitos y las estaciones meteorol\u00f3gicas. Puede acceder al panel administrador de SatLomas ingresando aqu\u00ed: https://api.satlomas.pe.undp.org/admin Para entrar deber\u00e1 ingresar el mismo nombre de usuario y contrase\u00f1a con la que ingresa al panel de usuario de SatLomas.","title":"Administradores"},{"location":"usage/#panel-de-administracion","text":"Desde el panel de administraci\u00f3n podr\u00e1 acceder a los diferentes modelos de las aplicaciones internas de la plataforma. Muchas de ellas son de solo lectura ya que no est\u00e1n pensadas para ser modificadas desde el panel administador, pero a efectos de depuraci\u00f3n y testeo se mantuvieron.","title":"Panel de administraci\u00f3n"},{"location":"usage/#usuarios_1","text":"Desde la secci\u00f3n Usuarios puede crear nuevos usuarios, modificar alguno existente o desactivarlo. Un usuario tiene 2 tipos de permisos: Activo : Determina si el usuario est\u00e1 activo o no. Puede desmarcar esta opcion sobre un usuario existente para desactivarlo en vez de borrarlo. Es staff : Indica si el usuario puede entrar al sitio de administrador. Un administrador tiene este casillero activado. En caso de querer registrar un nuevo usuario, deber\u00e1 escribir un nombre de usuario y una contrase\u00f1a.","title":"Usuarios"},{"location":"usage/#ambitos","text":"En la secci\u00f3n de \u00c1mbitos ( Scopes ) se pueden listar, modificar, eliminar o agregar nuevos \u00e1mbitos. Al editar un \u00e1mbito, o crear uno nuevo, se puede asignar un nombre y tipo de \u00e1mbito, y dibujar sobre un mapa un multipol\u00edgono para la geometr\u00eda. Tambi\u00e9n es posible cargar un archivo vectorial en formato GeoJSON. Este archivo vectorial debe tener un \u00fanico feature con un multipol\u00edgono o pol\u00edgono de geometr\u00eda.","title":"\u00c1mbitos"},{"location":"usage/#estaciones-meteorologicas_1","text":"En la secci\u00f3n de Estaciones Meteorol\u00f3gicas ( Stations ) se pueden listar, modificar, eliminar o agregar nuevas estaciones meteorol\u00f3gicas (Station) y nuevos sitios (Site). Al momento de crear un nuevo sitio, es necesario asegurarse que la estaci\u00f3n est\u00e9 creada primero. Cada estaci\u00f3n tiene un c\u00f3digo un\u00edvoco que las identifica. La plataforma solamente cargar\u00e1 los datos que recibe si reconoce el c\u00f3digo, dado que los datos se asocian exactamente a una estaci\u00f3n. El c\u00f3digo ( code ) de la estaci\u00f3n debe coincidir con el c\u00f3digo asignado a los sensores al momento de la carga de mediciones. Tambi\u00e9n se incluye un campo de metadatos en formato JSON, en caso de que sea necesario guardar informaci\u00f3n externa a la plataforma. Al editar o crear un Sitio, se le debe asignar un nombre, las coordenadas geogr\u00e1ficas (en proyecci\u00f3n WGS84), y opcionalmente asociarlo a una estaci\u00f3n cargada. Esta asociaci\u00f3n puede hacerle luego en una edici\u00f3n posterior. Tambi\u00e9n existe la posibilidad de agregarle atributos opcionales relacionados con el sitio.","title":"Estaciones meteorol\u00f3gicas"},{"location":"usage/#traslado-de-estaciones","text":"Dado que la estaciones pueden ser trasladadas de un sitio a otro, la plataforma ofrece un mecanismo que permite realizar el traslado, sin p\u00e9rdida de continuidad y consistencia de los datos a lo largo del tiempo. Suponiendo que se quiere trasladar una estaci\u00f3n del sitio \"A\" al sitio \"B\", a modo de ejemplo se proceder\u00eda de la siguiente manera: Se desconecta y desacopla la estaci\u00f3n ubicada en el sitio A En el administrador, se edita el sitio \"A\" y se desasocia la estaci\u00f3n. Este paso se realiza para que, al momento de encender la estaci\u00f3n ya ubicado en el sitio B, no se carguen erroneamente datos asociados al sitio A. Se traslada la estaci\u00f3n al sitio B. En el administrador, se crea el sitio B (si no exist\u00eda), y se asocia la estaci\u00f3n al sitio B. Se enciende la estaci\u00f3n, ya conectada a la red LoraWan. Es importante asegurarse que la estaci\u00f3n est\u00e9 desasociada del sitio original antes del traslado, y por otro lado, que la estaci\u00f3n ya est\u00e9 asociada al sitio nuevo antes de volver a conectarse. De esta manera, se podr\u00e1 asegurar que los datos est\u00e9n cargados correctamente y no haya p\u00e9rdida de informaci\u00f3n durante el proceso. En caso de interrupciones de conectividad o de energ\u00eda en las estaciones, la plataforma no se ver\u00e1 afectada y volver\u00e1 a recolectar datos autom\u00e1ticamente.","title":"Traslado de estaciones"},{"location":"usage/#auditoria","text":"La plataforma tiene integrado un sistema de auditor\u00eda para todas las acciones realizadas por usuarios y por los procesos autom\u00e1ticos. Podr\u00e1 consultarla yendo a la Entradas de registro (en Audit Log ).","title":"Auditor\u00eda"}]}